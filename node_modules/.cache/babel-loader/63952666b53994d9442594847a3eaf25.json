{"ast":null,"code":"import _objectSpread from\"D:/Python files/Start Django/blog_tube/frontend/blog_tube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/Python files/Start Django/blog_tube/frontend/blog_tube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useContext,useEffect,useState,useRef,useCallback,useMemo}from\"react\";import{useHistory}from\"react-router\";import{Blog}from\"./appUploadBlog\";import{BlogiansMiniProfile}from\"./appBlogians\";import{Helmet}from'react-helmet';import DOMPurify from'dompurify';import appConfig from'./statics/appConfig.json';import'./statics/css/appUploadBlog.css';import'./statics/css/appBlog.css';import view_logo from\"./statics/images/preview.svg\";import like_logo from\"./statics/images/like.svg\";import dislike_logo from\"./statics/images/dislike.svg\";import{Login_context}from\"../App\";import UserImage from\"./userImage\";import{logout}from\"./statics/utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AppBlog=function AppBlog(props){var url=window.location.hash.split(\"?\")[1];var blog_id=url.split(\"=\")[1];var history=useHistory();if(blog_id===null){history.push('/Error');}var _useState=useState([]),_useState2=_slicedToArray(_useState,2),blog_data_list=_useState2[0],set_blog_data_list=_useState2[1];var _useState3=useState({likes:\"\",dislikes:\"\",views:\"\",title:\"\",image_url:\"\",discription:\"\",blogger_details:{}}),_useState4=_slicedToArray(_useState3,2),blog_details=_useState4[0],set_blog_details=_useState4[1];var _ref=useRef({});useEffect(function(){var xhr=new XMLHttpRequest();xhr.open('GET',appConfig.origin+'backend_api/getBlog?blog_id='+blog_id);xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var response=JSON.parse(xhr.response);switch(response.status){case\"success\":set_blog_data_list(response.blog);set_blog_details({likes:response.likes,dislikes:response.dislikes,views:response.views,title:response.title,image_url:response.image_url,blogger_details:response.blogger_details});break;case\"page_not_found\":history.push('/Error');break;case\"fail\":history.push('/Error');break;default:break;}}};xhr.send();},[]);useEffect(function(){var ele=document.getElementsByClassName(\"appbody\")[0];ele.scrollTo(0,0);},[blog_details]);var container_ref=useRef({});return/*#__PURE__*/_jsxs(\"div\",{className:\"blog_page\",ref:function ref(el){return _ref.current.blog_page=el;},children:[/*#__PURE__*/_jsxs(Helmet,{children:[/*#__PURE__*/_jsx(\"title\",{children:blog_details.title}),/*#__PURE__*/_jsx(\"meta\",{name:\"Description\",content:blog_details.discription})]}),/*#__PURE__*/_jsx(\"h2\",{align:\"center\",children:blog_details.title}),/*#__PURE__*/_jsx(\"img\",{src:blog_details.image_url,className:\"title_image\",loading:\"eager\"}),/*#__PURE__*/_jsx(BlogiansMiniProfile,{user_details:blog_details.blogger_details,onClick:function onClick(){return null;},to:\"/Profile/\".concat(blog_details.blogger_details.user_id)}),/*#__PURE__*/_jsx(Blog,{children:blog_data_list.map(function(item,index){return/*#__PURE__*/_jsx(\"div\",{className:\"container_data\",children:DOMPurify.sanitize(item)},index);})}),/*#__PURE__*/_jsx(ReviewBlog,{blog_id:blog_id,likes:blog_details.likes,dislikes:blog_details.dislikes,views:blog_details.views}),/*#__PURE__*/_jsx(Comments,{blog_id:blog_id,appbodyloading:props.appbodyloading})]});};export default AppBlog;var ReviewBlog=function ReviewBlog(props){var session_id=useContext(Login_context);var history=useHistory();var _useState5=useState(\"not yet\"),_useState6=_slicedToArray(_useState5,2),reviewed=_useState6[0],set_reviewed=_useState6[1];var _useState7=useState({likes:props.likes,dislikes:props.dislikes,views:props.views}),_useState8=_slicedToArray(_useState7,2),reviews=_useState8[0],set_reviews=_useState8[1];var _ref2=useRef({});useEffect(function(){set_reviews({likes:props.likes,dislikes:props.dislikes,views:props.views});},[props.likes,props.dislikes,props.views]);var review=useCallback(function(event){var opt=event.target.value;if(session_id===sessionStorage.session){var xhr=new XMLHttpRequest();var uid=JSON.parse(sessionStorage.login_data).user_id;xhr.open('POST',appConfig.origin+\"backend_api/Blogreview\");xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var response=JSON.parse(xhr.response);if(response.status===\"success\"){set_reviews(_objectSpread({},response.details));}}};var formdata=new FormData();formdata.append('uid',uid);formdata.append('bid',props.blog_id);formdata.append('review',opt);xhr.send(formdata);}else{history.push('/Error');}},[session_id,props.blog_id]);useEffect(function(){if(session_id===sessionStorage.session&&Boolean(session_id)&&Boolean(sessionStorage.session)){var xhr=new XMLHttpRequest();var uid=JSON.parse(sessionStorage.login_data).user_id;xhr.open('GET',appConfig.origin+\"backend_api/checkReviewr?bid=\".concat(props.blog_id,\"&uid=\").concat(uid));xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var response=JSON.parse(xhr.response);if(response.status===\"success\"){set_reviewed(response.isreviewer);}}};xhr.send();}},[session_id]);useEffect(function(){if(reviewed===\"like\"){_ref2.current.like.click();}else if(reviewed===\"dislike\"){_ref2.current.dislike.click();}},[reviewed]);return/*#__PURE__*/_jsxs(\"div\",{className:\"review\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"review\",ref:function ref(el){return _ref2.current.like=el;},id:\"like\",value:\"like\",onInput:function onInput(e){return review(e);},hidden:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"like\",id:\"like_label\",style:{backgroundImage:\"url(\".concat(like_logo,\")\")},children:reviews.likes>0?reviews.likes:\"No Likes\"}),/*#__PURE__*/_jsx(\"label\",{id:\"view_label\",style:{backgroundImage:\"url(\".concat(view_logo,\")\")},children:reviews.views>0?reviews.views:\"No Views\"}),/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"review\",ref:function ref(el){return _ref2.current.dislike=el;},id:\"dislike\",value:\"dislike\",onInput:function onInput(e){return review(e);},disabled:!session_id,hidden:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"dislike\",id:\"dislike_label\",style:{backgroundImage:\"url(\".concat(dislike_logo,\")\")},children:reviews.dislikes>0?reviews.dislikes:\"No Dislikes\"})]});};var Comments=function Comments(props){var session_id=useContext(Login_context);var _ref3=useRef({});var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),login_status=_useState10[0],set_login_status=_useState10[1];var history=useHistory();useEffect(function(){if(session_id===sessionStorage.session&&Boolean(session_id)&&Boolean(sessionStorage.session)){set_login_status(true);}else{set_login_status(false);}},[session_id,sessionStorage]);var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),comment_list=_useState12[0],set_comment_list=_useState12[1];var update_comments=useCallback(function(){var xhr=new XMLHttpRequest();xhr.open('POST',appConfig.origin+\"backend_api/getComments\");xhr.onreadystatechange=function(){if(xhr.status===200&&xhr.readyState===4){var response=JSON.parse(xhr.response);switch(response.status){case\"success\":set_comment_list(response.comment_list);break;case\"loginRequired\":console.log(\"backend_api/getComments\");logout();history.push(\"/Login\");break;default:console.log(response.status);break;}}};var formdata=new FormData();formdata.append('blog_id',props.blog_id);xhr.send(formdata);},[comment_list,_ref3]);useEffect(function(){update_comments();},[props.blog_id]);useEffect(function(){return _ref3.current.comment_list.scrollTo(0,0);},[comment_list,_ref3]);var send_comment=useCallback(function(){var comment=_ref3.current.comment_input.value;if(session_id===sessionStorage.session&&comment!==''){var xhr=new XMLHttpRequest();xhr.open(\"POST\",appConfig.origin+\"backend_api/uploadComment\");props.appbodyloading('flex');xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var response=JSON.parse(xhr.response);_ref3.current.comment_input.value='';switch(response.status){case\"success\":console.log(response);update_comments();props.appbodyloading('none');break;case\"loginRequired\":console.log(response.status);logout();history.push(\"/Login\");props.appbodyloading('none');break;case\"fail\":console.log(response.status);history.push(\"/Error\");props.appbodyloading('none');break;default:console.log(response.status);props.appbodyloading('none');break;// list has to be updated here\n}}};var formdata=new FormData();xhr.setRequestHeader(\"session\",session_id);formdata.append(\"comment\",comment);formdata.append(\"user_id\",JSON.parse(sessionStorage.login_data).user_id);formdata.append(\"blog_id\",props.blog_id);xhr.send(formdata);}},[session_id,_ref3.current,sessionStorage]);var cList=useMemo(function(){return comment_list.map(function(item){return/*#__PURE__*/_jsx(Comment,{c_detials:item},item.cid);});});var nList=useMemo(function(){return/*#__PURE__*/_jsx(\"span\",{style:{display:\"grid\",placeItems:\"center\",fontSize:\"30px\",width:\"100%\",height:\"100%\"},id:\"no_comments\",children:\"No Comments\\uD83D\\uDE05\"});});return/*#__PURE__*/_jsxs(\"div\",{className:\"comments\",children:[/*#__PURE__*/_jsx(\"h5\",{align:\"center\",children:\"Comments\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cover\",children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"comment\",maxLength:1000,id:\"comment_input\",disabled:!login_status,ref:function ref(el){return _ref3.current.comment_input=el;},cols:\"3\",rows:\"5\"}),/*#__PURE__*/_jsx(\"button\",{ref:function ref(el){return _ref3.current.send_comment=el;},disabled:!login_status,id:\"send_comment\",onClick:function onClick(){return send_comment();}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment_list\",ref:function ref(el){return _ref3.current.comment_list=el;},children:comment_list.length===0?nList:cList})]});};var Comment=function Comment(props){return/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",id:props.key,children:[/*#__PURE__*/_jsx(UserImage,{user_id:props.c_detials.uid,width:\"50px\",height:\"50px\",style:{gridArea:\"user_image\",borderWidth:\"2px\",alignSelf:\"center\",justifySelf:\"center\"},to:\"/Profile/\".concat(props.c_detials.uid),onClick:function onClick(){return null;}}),/*#__PURE__*/_jsx(\"span\",{id:\"user_name\",children:props.c_detials.name}),/*#__PURE__*/_jsx(\"p\",{className:\"comment_text\",style:{whiteSpace:\"break-spaces\"},children:props.c_detials.text}),/*#__PURE__*/_jsx(\"div\",{className:\"datetime\",children:props.c_detials.upload_datetime})]});};export{Comment};","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/src/componenets/appBlog.js"],"names":["useContext","useEffect","useState","useRef","useCallback","useMemo","useHistory","Blog","BlogiansMiniProfile","Helmet","DOMPurify","appConfig","Login_context","UserImage","logout","AppBlog","props","url","window","location","hash","split","blog_id","history","push","blog_data_list","set_blog_data_list","likes","dislikes","views","title","image_url","discription","blogger_details","blog_details","set_blog_details","ref","xhr","XMLHttpRequest","open","origin","onreadystatechange","readyState","status","response","JSON","parse","blog","send","ele","document","getElementsByClassName","scrollTo","container_ref","el","current","blog_page","user_id","map","item","index","sanitize","appbodyloading","ReviewBlog","session_id","reviewed","set_reviewed","reviews","set_reviews","review","event","opt","target","value","sessionStorage","session","uid","login_data","details","formdata","FormData","append","Boolean","isreviewer","like","click","dislike","e","backgroundImage","like_logo","view_logo","dislike_logo","Comments","login_status","set_login_status","comment_list","set_comment_list","update_comments","console","log","send_comment","comment","comment_input","setRequestHeader","cList","cid","nList","display","placeItems","fontSize","width","height","length","Comment","key","c_detials","gridArea","borderWidth","alignSelf","justifySelf","name","whiteSpace","text","upload_datetime"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState ,useRef, useCallback, useMemo} from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Blog } from \"./appUploadBlog\";\r\nimport { BlogiansMiniProfile } from \"./appBlogians\";\r\nimport {Helmet} from 'react-helmet'\r\nimport DOMPurify from 'dompurify'\r\nimport appConfig from './statics/appConfig.json'\r\nimport './statics/css/appUploadBlog.css'\r\nimport './statics/css/appBlog.css'\r\nimport view_logo from './statics/images/preview.svg'\r\nimport like_logo from './statics/images/like.svg'\r\nimport dislike_logo from './statics/images/dislike.svg'\r\nimport { Login_context } from \"../App\";\r\nimport UserImage from \"./userImage\";\r\nimport { logout } from \"./statics/utils\";\r\n\r\nconst AppBlog  = props=>{\r\n    const url = window.location.hash.split(\"?\")[1]\r\n    const blog_id = url.split(\"=\")[1]\r\n    const history = useHistory()\r\n    if (blog_id === null){\r\n        history.push('/Error')\r\n    }\r\n\r\n    const [blog_data_list , set_blog_data_list] = useState([])\r\n    const [blog_details , set_blog_details] = useState({likes:\"\" , dislikes:\"\" ,\r\n     views :\"\" , title:\"\" , image_url:\"\",discription:\"\",blogger_details:{}})\r\n\r\n     const ref = useRef({})\r\n    useEffect(()=>{\r\n    const xhr = new XMLHttpRequest()\r\n    xhr.open('GET' ,appConfig.origin+'backend_api/getBlog?blog_id='+blog_id )\r\n    xhr.onreadystatechange =()=>{\r\n        if (xhr.readyState === 4 && xhr.status === 200){\r\n            let response = JSON.parse(xhr.response)\r\n            switch (response.status){\r\n                case \"success\":\r\n                    set_blog_data_list(response.blog)\r\n                    set_blog_details({likes:response.likes ,\r\n                                      dislikes:response.dislikes ,\r\n                                    views:response.views ,\r\n                                title :response.title ,\r\n                            image_url:response.image_url,\r\n                                blogger_details : response.blogger_details})\r\n                    break;\r\n                case \"page_not_found\":\r\n                    history.push('/Error')\r\n                    break;\r\n                case \"fail\":\r\n                    history.push('/Error')\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    xhr.send()\r\n\r\n    },[])\r\n\r\n\r\n    useEffect(()=>{\r\n        let ele  = document.getElementsByClassName(\"appbody\")[0]\r\n        ele.scrollTo(0,0)\r\n    },[blog_details])\r\n\r\n    const container_ref = useRef({})\r\n\r\n\r\n    return(<div  className = \"blog_page\" ref ={el=>ref.current.blog_page = el}  >\r\n        <Helmet>\r\n            <title>{blog_details.title}</title>\r\n            <meta name=\"Description\" content = {blog_details.discription} />\r\n        </Helmet>\r\n        <h2 align = \"center\">{blog_details.title}</h2>\r\n        <img src = {blog_details.image_url} className = \"title_image\" loading = {\"eager\"} />\r\n        <BlogiansMiniProfile user_details = {blog_details.blogger_details} onClick={()=>null}  to ={`/Profile/${blog_details.blogger_details.user_id}`} />\r\n        <Blog>\r\n            {blog_data_list.map((item,index)=>(<div key = {index} className = \"container_data\"   >{DOMPurify.sanitize(item)}</div>))}\r\n        </Blog>\r\n        <ReviewBlog blog_id = {blog_id} likes = {blog_details.likes} dislikes= {blog_details.dislikes} views= {blog_details.views} />\r\n        <Comments  blog_id = {blog_id} appbodyloading={props.appbodyloading} />\r\n    </div>)\r\n}\r\n\r\nexport default AppBlog\r\n\r\nconst ReviewBlog=props=>{\r\n    const session_id = useContext(Login_context)\r\n    const history = useHistory()\r\n    const[ reviewed  ,set_reviewed] = useState(\"not yet\")\r\n    const[reviews ,set_reviews] =useState({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    const ref = useRef({})\r\n    useEffect(()=>{\r\n        set_reviews({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    },[props.likes , props.dislikes , props.views])\r\n\r\n    const review=useCallback(event=>{\r\n        let opt = event.target.value\r\n        if (session_id === sessionStorage.session ){\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(sessionStorage.login_data).user_id\r\n            xhr.open('POST' , appConfig.origin+`backend_api/Blogreview`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviews({...response.details})\r\n                }\r\n            }}\r\n            let formdata = new FormData()\r\n            formdata.append('uid' , uid)\r\n            formdata.append('bid' , props.blog_id)\r\n            formdata.append('review' , opt)\r\n            xhr.send(formdata)\r\n        }else{\r\n            history.push('/Error')\r\n        }\r\n    },[session_id,props.blog_id ])\r\n    useEffect(()=>{\r\n        if (session_id===sessionStorage.session && (Boolean(session_id) && Boolean(sessionStorage.session))){\r\n\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(sessionStorage.login_data).user_id\r\n            xhr.open('GET' , appConfig.origin+`backend_api/checkReviewr?bid=${props.blog_id}&uid=${uid}`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviewed( response.isreviewer)\r\n                }\r\n            }}\r\n            xhr.send()\r\n        }\r\n    },[session_id])\r\n    useEffect(()=>{\r\n        if (reviewed === \"like\"){\r\n            ref.current.like.click()\r\n        }else if (reviewed === \"dislike\"){\r\n            ref.current.dislike.click()\r\n        }\r\n    },[reviewed])\r\n\r\n    \r\n    return(\r\n        <div className=\"review\">\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.like = el}  id=\"like\" value= {\"like\"} onInput={e=>review(e)}  hidden/>\r\n            <label htmlFor=\"like\" id=\"like_label\" style={{backgroundImage:`url(${like_logo})`}} >{reviews.likes>0?reviews.likes:\"No Likes\"}</label>\r\n            <label id =\"view_label\" style={{backgroundImage:`url(${view_logo})`}}>{reviews.views>0?reviews.views:\"No Views\"}</label>\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.dislike = el}  id=\"dislike\" value={\"dislike\"} onInput={e=>review(e)} disabled={!session_id} hidden/>\r\n            <label htmlFor=\"dislike\" id=\"dislike_label\" style={{backgroundImage:`url(${dislike_logo})`}}  >{reviews.dislikes>0?reviews.dislikes:\"No Dislikes\"}</label>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Comments =props=>{\r\n    let session_id = useContext(Login_context)\r\n    const ref = useRef({})\r\n    const [login_status , set_login_status] = useState(false)\r\n    const history = useHistory()\r\n    useEffect(()=>{\r\n        if(session_id === sessionStorage.session && (Boolean(session_id) && Boolean(sessionStorage.session))){\r\n            set_login_status(true)\r\n        }else{\r\n            set_login_status(false)\r\n        }\r\n    },[session_id,sessionStorage])\r\n\r\n    const [comment_list , set_comment_list] = useState([])\r\n\r\n    const update_comments= useCallback(()=>{\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST' , appConfig.origin+`backend_api/getComments`)\r\n        xhr.onreadystatechange=()=>{\r\n            if(xhr.status===200 && xhr.readyState === 4 ){\r\n                let response = JSON.parse(xhr.response)\r\n                switch (response.status) {\r\n                    case \"success\":\r\n                        set_comment_list(response.comment_list)\r\n                        break;\r\n                    case \"loginRequired\":\r\n                        console.log(`backend_api/getComments`)\r\n                        logout()\r\n                        history.push(\"/Login\")\r\n                        break;\r\n                \r\n                    default:\r\n                        console.log(response.status)\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        let formdata = new FormData()\r\n        formdata.append('blog_id' , props.blog_id)\r\n        xhr.send(formdata)\r\n    },[comment_list,ref])\r\n\r\n    useEffect(()=>{\r\n        update_comments()\r\n    },[props.blog_id])\r\n    useEffect(()=>ref.current.comment_list.scrollTo(0,0),[comment_list,ref])\r\n\r\n    const send_comment = useCallback(()=>{\r\n        let comment = ref.current.comment_input.value\r\n        if (session_id === sessionStorage.session &&  comment !== ''){\r\n            const xhr = new XMLHttpRequest()\r\n            xhr.open(\"POST\" , appConfig.origin+`backend_api/uploadComment`)\r\n            props.appbodyloading('flex')\r\n            xhr.onreadystatechange = ()=>{\r\n                if(xhr.readyState === 4 && xhr.status === 200){\r\n                let response = JSON.parse(xhr.response) \r\n                ref.current.comment_input.value =''\r\n                switch (response.status) {\r\n                    case \"success\":\r\n                        console.log(response)\r\n                        update_comments()\r\n                        props.appbodyloading('none')\r\n                        break;\r\n                    case \"loginRequired\":\r\n                        console.log(response.status)\r\n                        logout()\r\n                        history.push(\"/Login\")\r\n                        props.appbodyloading('none')\r\n                        break;\r\n                    case \"fail\":\r\n                        console.log(response.status)\r\n                        history.push(\"/Error\") \r\n                        props.appbodyloading('none')\r\n                        break;              \r\n                    default:\r\n                        console.log(response.status)\r\n                        props.appbodyloading('none')\r\n                        break;                                 // list has to be updated here\r\n            }}}\r\n            const formdata = new FormData()\r\n            xhr.setRequestHeader(\"session\" ,session_id )\r\n            formdata.append(\"comment\" , comment)\r\n            formdata.append(\"user_id\"  , JSON.parse(sessionStorage.login_data).user_id)\r\n            formdata.append(\"blog_id\" , props.blog_id)\r\n            xhr.send(formdata)\r\n        }\r\n    \r\n    },[session_id,ref.current,sessionStorage])\r\n    const cList = useMemo(()=>(comment_list.map(item=>(<Comment c_detials = {item} key ={item.cid} />))))\r\n    const nList = useMemo(()=>(<span style ={{display:\"grid\",placeItems:\"center\",\r\n    fontSize:\"30px\",width:\"100%\" ,height:\"100%\"}} id = \"no_comments\">No Comments😅</span>))\r\n    return(<div className=\"comments\">\r\n            \r\n                <h5 align = \"center\">Comments</h5>\r\n                <div className=\"cover\">\r\n                <textarea name=\"comment\" maxLength={1000} id=\"comment_input\"  disabled={!login_status}\r\n                ref={el=>ref.current.comment_input = el} cols=\"3\" rows=\"5\">\r\n                </textarea>\r\n                <button ref = {el=>ref.current.send_comment = el} disabled= {!login_status}\r\n                   id=\"send_comment\" onClick = {()=>send_comment()} ></button>\r\n                </div>\r\n                <div className=\"comment_list\" ref = { el=>ref.current.comment_list = el}>\r\n                    {comment_list.length ===0?nList: cList }\r\n                </div>\r\n            </div>\r\n    )\r\n}\r\n\r\nconst Comment = props=>{\r\n    return (\r\n        <div className=\"comment\" id = {props.key}>\r\n            <UserImage user_id= {props.c_detials.uid} width={\"50px\"} height=\"50px\"\r\n             style= {{gridArea :\"user_image\" , borderWidth : \"2px\" , alignSelf : \"center\" , justifySelf: \"center\"}}\r\n             to = {`/Profile/${props.c_detials.uid}`} onClick={()=>null} />\r\n            <span id=\"user_name\">{props.c_detials.name}</span>\r\n            <p className=\"comment_text\" style={{whiteSpace:\"break-spaces\"}}>{props.c_detials.text}</p>\r\n            <div className=\"datetime\">{props.c_detials.upload_datetime}</div>\r\n        </div>\r\n    )\r\n}\r\nexport {Comment}"]},"metadata":{},"sourceType":"module"}