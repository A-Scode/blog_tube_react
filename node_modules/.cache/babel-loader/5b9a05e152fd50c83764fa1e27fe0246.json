{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar referenceVisitor = {\n  ReferencedIdentifier: function ReferencedIdentifier(path, state) {\n    if (path.isJSXIdentifier() && _babelTypes.react.isCompatTag(path.node.name) && !path.parentPath.isJSXMemberExpression()) {\n      return;\n    }\n\n    if (path.node.name === \"this\") {\n      var scope = path.scope;\n\n      do {\n        if (scope.path.isFunction() && !scope.path.isArrowFunctionExpression()) break;\n      } while (scope = scope.parent);\n\n      if (scope) state.breakOnScopePaths.push(scope.path);\n    }\n\n    var binding = path.scope.getBinding(path.node.name);\n    if (!binding) return;\n    if (binding !== state.scope.getBinding(path.node.name)) return;\n    state.bindings[path.node.name] = binding;\n  }\n};\n\nvar PathHoister = function () {\n  function PathHoister(path, scope) {\n    (0, _classCallCheck3.default)(this, PathHoister);\n    this.breakOnScopePaths = [];\n    this.bindings = {};\n    this.scopes = [];\n    this.scope = scope;\n    this.path = path;\n    this.attachAfter = false;\n  }\n\n  PathHoister.prototype.isCompatibleScope = function isCompatibleScope(scope) {\n    for (var key in this.bindings) {\n      var binding = this.bindings[key];\n\n      if (!scope.bindingIdentifierEquals(key, binding.identifier)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  PathHoister.prototype.getCompatibleScopes = function getCompatibleScopes() {\n    var scope = this.path.scope;\n\n    do {\n      if (this.isCompatibleScope(scope)) {\n        this.scopes.push(scope);\n      } else {\n        break;\n      }\n\n      if (this.breakOnScopePaths.indexOf(scope.path) >= 0) {\n        break;\n      }\n    } while (scope = scope.parent);\n  };\n\n  PathHoister.prototype.getAttachmentPath = function getAttachmentPath() {\n    var path = this._getAttachmentPath();\n\n    if (!path) return;\n    var targetScope = path.scope;\n\n    if (targetScope.path === path) {\n      targetScope = path.scope.parent;\n    }\n\n    if (targetScope.path.isProgram() || targetScope.path.isFunction()) {\n      for (var name in this.bindings) {\n        if (!targetScope.hasOwnBinding(name)) continue;\n        var binding = this.bindings[name];\n        if (binding.kind === \"param\") continue;\n\n        if (this.getAttachmentParentForPath(binding.path).key > path.key) {\n          this.attachAfter = true;\n          path = binding.path;\n\n          for (var _iterator = binding.constantViolations, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n            var _ref;\n\n            if (_isArray) {\n              if (_i >= _iterator.length) break;\n              _ref = _iterator[_i++];\n            } else {\n              _i = _iterator.next();\n              if (_i.done) break;\n              _ref = _i.value;\n            }\n\n            var violationPath = _ref;\n\n            if (this.getAttachmentParentForPath(violationPath).key > path.key) {\n              path = violationPath;\n            }\n          }\n        }\n      }\n    }\n\n    if (path.parentPath.isExportDeclaration()) {\n      path = path.parentPath;\n    }\n\n    return path;\n  };\n\n  PathHoister.prototype._getAttachmentPath = function _getAttachmentPath() {\n    var scopes = this.scopes;\n    var scope = scopes.pop();\n    if (!scope) return;\n\n    if (scope.path.isFunction()) {\n      if (this.hasOwnParamBindings(scope)) {\n        if (this.scope === scope) return;\n        return scope.path.get(\"body\").get(\"body\")[0];\n      } else {\n        return this.getNextScopeAttachmentParent();\n      }\n    } else if (scope.path.isProgram()) {\n      return this.getNextScopeAttachmentParent();\n    }\n  };\n\n  PathHoister.prototype.getNextScopeAttachmentParent = function getNextScopeAttachmentParent() {\n    var scope = this.scopes.pop();\n    if (scope) return this.getAttachmentParentForPath(scope.path);\n  };\n\n  PathHoister.prototype.getAttachmentParentForPath = function getAttachmentParentForPath(path) {\n    do {\n      if (!path.parentPath || Array.isArray(path.container) && path.isStatement() || path.isVariableDeclarator() && path.parentPath.node !== null && path.parentPath.node.declarations.length > 1) return path;\n    } while (path = path.parentPath);\n  };\n\n  PathHoister.prototype.hasOwnParamBindings = function hasOwnParamBindings(scope) {\n    for (var name in this.bindings) {\n      if (!scope.hasOwnBinding(name)) continue;\n      var binding = this.bindings[name];\n      if (binding.kind === \"param\" && binding.constant) return true;\n    }\n\n    return false;\n  };\n\n  PathHoister.prototype.run = function run() {\n    var node = this.path.node;\n    if (node._hoisted) return;\n    node._hoisted = true;\n    this.path.traverse(referenceVisitor, this);\n    this.getCompatibleScopes();\n    var attachTo = this.getAttachmentPath();\n    if (!attachTo) return;\n    if (attachTo.getFunctionParent() === this.path.getFunctionParent()) return;\n    var uid = attachTo.scope.generateUidIdentifier(\"ref\");\n    var declarator = t.variableDeclarator(uid, this.path.node);\n    var insertFn = this.attachAfter ? \"insertAfter\" : \"insertBefore\";\n    attachTo[insertFn]([attachTo.isVariableDeclarator() ? declarator : t.variableDeclaration(\"var\", [declarator])]);\n    var parent = this.path.parentPath;\n\n    if (parent.isJSXElement() && this.path.container === parent.node.children) {\n      uid = t.JSXExpressionContainer(uid);\n    }\n\n    this.path.replaceWith(uid);\n  };\n\n  return PathHoister;\n}();\n\nexports.default = PathHoister;\nmodule.exports = exports[\"default\"];","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/node_modules/babel-traverse/lib/path/lib/hoister.js"],"names":["exports","__esModule","_getIterator2","require","_getIterator3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_babelTypes","t","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","referenceVisitor","ReferencedIdentifier","path","state","isJSXIdentifier","react","isCompatTag","node","name","parentPath","isJSXMemberExpression","scope","isFunction","isArrowFunctionExpression","parent","breakOnScopePaths","push","binding","getBinding","bindings","PathHoister","scopes","attachAfter","isCompatibleScope","bindingIdentifierEquals","identifier","getCompatibleScopes","indexOf","getAttachmentPath","_getAttachmentPath","targetScope","isProgram","hasOwnBinding","kind","getAttachmentParentForPath","_iterator","constantViolations","_isArray","Array","isArray","_i","_ref","length","next","done","value","violationPath","isExportDeclaration","pop","hasOwnParamBindings","get","getNextScopeAttachmentParent","container","isStatement","isVariableDeclarator","declarations","constant","run","_hoisted","traverse","attachTo","getFunctionParent","uid","generateUidIdentifier","declarator","variableDeclarator","insertFn","variableDeclaration","isJSXElement","children","JSXExpressionContainer","replaceWith","module"],"mappings":"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","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar referenceVisitor = {\n  ReferencedIdentifier: function ReferencedIdentifier(path, state) {\n    if (path.isJSXIdentifier() && _babelTypes.react.isCompatTag(path.node.name) && !path.parentPath.isJSXMemberExpression()) {\n      return;\n    }\n\n    if (path.node.name === \"this\") {\n      var scope = path.scope;\n      do {\n        if (scope.path.isFunction() && !scope.path.isArrowFunctionExpression()) break;\n      } while (scope = scope.parent);\n      if (scope) state.breakOnScopePaths.push(scope.path);\n    }\n\n    var binding = path.scope.getBinding(path.node.name);\n    if (!binding) return;\n\n    if (binding !== state.scope.getBinding(path.node.name)) return;\n\n    state.bindings[path.node.name] = binding;\n  }\n};\n\nvar PathHoister = function () {\n  function PathHoister(path, scope) {\n    (0, _classCallCheck3.default)(this, PathHoister);\n\n    this.breakOnScopePaths = [];\n\n    this.bindings = {};\n\n    this.scopes = [];\n\n    this.scope = scope;\n    this.path = path;\n\n    this.attachAfter = false;\n  }\n\n  PathHoister.prototype.isCompatibleScope = function isCompatibleScope(scope) {\n    for (var key in this.bindings) {\n      var binding = this.bindings[key];\n      if (!scope.bindingIdentifierEquals(key, binding.identifier)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  PathHoister.prototype.getCompatibleScopes = function getCompatibleScopes() {\n    var scope = this.path.scope;\n    do {\n      if (this.isCompatibleScope(scope)) {\n        this.scopes.push(scope);\n      } else {\n        break;\n      }\n\n      if (this.breakOnScopePaths.indexOf(scope.path) >= 0) {\n        break;\n      }\n    } while (scope = scope.parent);\n  };\n\n  PathHoister.prototype.getAttachmentPath = function getAttachmentPath() {\n    var path = this._getAttachmentPath();\n    if (!path) return;\n\n    var targetScope = path.scope;\n\n    if (targetScope.path === path) {\n      targetScope = path.scope.parent;\n    }\n\n    if (targetScope.path.isProgram() || targetScope.path.isFunction()) {\n      for (var name in this.bindings) {\n        if (!targetScope.hasOwnBinding(name)) continue;\n\n        var binding = this.bindings[name];\n\n        if (binding.kind === \"param\") continue;\n\n        if (this.getAttachmentParentForPath(binding.path).key > path.key) {\n          this.attachAfter = true;\n          path = binding.path;\n\n          for (var _iterator = binding.constantViolations, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n            var _ref;\n\n            if (_isArray) {\n              if (_i >= _iterator.length) break;\n              _ref = _iterator[_i++];\n            } else {\n              _i = _iterator.next();\n              if (_i.done) break;\n              _ref = _i.value;\n            }\n\n            var violationPath = _ref;\n\n            if (this.getAttachmentParentForPath(violationPath).key > path.key) {\n              path = violationPath;\n            }\n          }\n        }\n      }\n    }\n\n    if (path.parentPath.isExportDeclaration()) {\n      path = path.parentPath;\n    }\n\n    return path;\n  };\n\n  PathHoister.prototype._getAttachmentPath = function _getAttachmentPath() {\n    var scopes = this.scopes;\n\n    var scope = scopes.pop();\n\n    if (!scope) return;\n\n    if (scope.path.isFunction()) {\n      if (this.hasOwnParamBindings(scope)) {\n        if (this.scope === scope) return;\n\n        return scope.path.get(\"body\").get(\"body\")[0];\n      } else {\n        return this.getNextScopeAttachmentParent();\n      }\n    } else if (scope.path.isProgram()) {\n      return this.getNextScopeAttachmentParent();\n    }\n  };\n\n  PathHoister.prototype.getNextScopeAttachmentParent = function getNextScopeAttachmentParent() {\n    var scope = this.scopes.pop();\n    if (scope) return this.getAttachmentParentForPath(scope.path);\n  };\n\n  PathHoister.prototype.getAttachmentParentForPath = function getAttachmentParentForPath(path) {\n    do {\n      if (!path.parentPath || Array.isArray(path.container) && path.isStatement() || path.isVariableDeclarator() && path.parentPath.node !== null && path.parentPath.node.declarations.length > 1) return path;\n    } while (path = path.parentPath);\n  };\n\n  PathHoister.prototype.hasOwnParamBindings = function hasOwnParamBindings(scope) {\n    for (var name in this.bindings) {\n      if (!scope.hasOwnBinding(name)) continue;\n\n      var binding = this.bindings[name];\n\n      if (binding.kind === \"param\" && binding.constant) return true;\n    }\n    return false;\n  };\n\n  PathHoister.prototype.run = function run() {\n    var node = this.path.node;\n    if (node._hoisted) return;\n    node._hoisted = true;\n\n    this.path.traverse(referenceVisitor, this);\n\n    this.getCompatibleScopes();\n\n    var attachTo = this.getAttachmentPath();\n    if (!attachTo) return;\n\n    if (attachTo.getFunctionParent() === this.path.getFunctionParent()) return;\n\n    var uid = attachTo.scope.generateUidIdentifier(\"ref\");\n    var declarator = t.variableDeclarator(uid, this.path.node);\n\n    var insertFn = this.attachAfter ? \"insertAfter\" : \"insertBefore\";\n    attachTo[insertFn]([attachTo.isVariableDeclarator() ? declarator : t.variableDeclaration(\"var\", [declarator])]);\n\n    var parent = this.path.parentPath;\n    if (parent.isJSXElement() && this.path.container === parent.node.children) {\n      uid = t.JSXExpressionContainer(uid);\n    }\n\n    this.path.replaceWith(uid);\n  };\n\n  return PathHoister;\n}();\n\nexports.default = PathHoister;\nmodule.exports = exports[\"default\"];"]},"metadata":{},"sourceType":"script"}