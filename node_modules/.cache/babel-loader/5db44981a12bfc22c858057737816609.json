{"ast":null,"code":"var _jsxFileName = \"D:\\\\Python files\\\\Start Django\\\\blog_tube\\\\frontend\\\\blog_tube\\\\src\\\\componenets\\\\appSignup.js\",\n    _s = $RefreshSig$();\n\nimport './statics/css/appSignup.css';\nimport { useState, useRef, useEffect, useCallback } from 'react';\nimport username from \"./statics/images/username.svg\";\nimport password from \"./statics/images/password.svg\";\nimport email from \"./statics/images/email.svg\";\nimport uplaod_background_image from \"./statics/images/upload_image_background.svg\";\nimport signup_background from \"./statics/images/signup_background.svg\";\nimport { Link } from 'react-router-dom';\nimport appConfig from './statics/appConfig.json';\nimport anime from 'animejs';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar AppSignup = props => {\n  _s();\n\n  let chars = {\n    \"!\": null,\n    \"#\": null,\n    \"$\": null,\n    \"%\": null,\n    \"^\": null,\n    \"&\": null,\n    \"*\": null,\n    \"(\": null,\n    \")\": null,\n    \"'\": null,\n    '\"': null,\n    \";\": null,\n    \":\": null\n  };\n\n  function checkUsername(event) {\n    event.preventDefault();\n    let filtered_list = [...event.target.value].filter(item => !(item in chars));\n    let list = [...event.target.value];\n\n    if (filtered_list.join('') == list.join('')) {\n      event.target.setCustomValidity(\"\");\n    } else if (event.nativeEvent.data === '\"' || event.nativeEvent.data === \"'\") {\n      event.target.value = event.target.value.slice(0, event.target.value.length - 1);\n    } else if (event.nativeEvent.data in chars) {\n      event.target.setCustomValidity(\"username should not contain \\n ------------ ?!:;\\\"'#$%^&*() ------------\");\n      event.target.reportValidity();\n    }\n  }\n\n  function removequotes(event) {\n    if (event.nativeEvent.data === '\"' || event.nativeEvent.data === \"'\") {\n      event.target.value = event.target.value.slice(0, event.target.value.length - 1);\n      event.target.setCustomValidity('Cannot use \" or \\' ');\n      event.target.reportValidity();\n    } else {\n      event.target.setCustomValidity('');\n    }\n  }\n\n  const ref = useRef({}); // useEffect for ref\n\n  useEffect(() => {\n    try {\n      anime({\n        targets: ref.current['signup_heading'],\n        update: function (anime) {\n          try {\n            ref.current['signup_heading'].style.filter = `hue-rotate(${anime.progress * 3.6}deg)`;\n          } catch (err) {}\n        },\n        duration: 2000,\n        autoplay: true,\n        direction: 'alternate',\n        loop: true\n      });\n      set_refs();\n    } catch (err) {\n      console.log(err);\n    }\n  }, [ref, block_state]);\n\n  let set_refs = () => {\n    ref.current['signup_form'].style.backgroundImage = `url(${signup_background})`;\n    ref.current['username'].style.backgroundImage = `url(${username})`;\n    ref.current['password'].style.backgroundImage = `url(${password})`;\n    ref.current['email'].style.backgroundImage = `url(${email})`;\n    ref.current['image'].style.backgroundImage = `url(${uplaod_background_image})`;\n  };\n\n  var [block_state, set_block_state] = useState('form');\n  const origin = appConfig.origin;\n  const data_ref = useRef({});\n\n  let submit_data = event => {\n    let xhr = new XMLHttpRequest();\n    props.appbodyloading('flex');\n\n    xhr.onreadystatechange = () => {\n      console.log(xhr.status, xhr.readyState);\n\n      if (xhr.status === 200 && xhr.readyState === 4) {\n        let response = JSON.parse(xhr.response);\n        console.log(response);\n\n        if (response.status === \"exists\") {\n          ref.current['email'].focus();\n          ref.current['email'].setCustomValidity('This Email Exists!!!');\n          ref.current['email'].reportValidity();\n          props.appbodyloading('none');\n        } else if (response.status === \"otp\") {\n          set_block_state(\"otp\");\n          ref.current['otp_input'].style.backgroundImage = `url(${password})`;\n          props.appbodyloading('none');\n        } else if (response.status === \"fail\") {\n          set_block_state(\"error\");\n          props.appbodyloading('none');\n        }\n      }\n    };\n\n    xhr.open('POST', origin + 'backend_api/signup');\n    let progressbar = document.getElementById('progressbar');\n    xhr.upload.addEventListener('progress', event => {\n      let percent = Math.round(event.loaded / event.total * 100);\n      progressbar.style.width = `${percent}%`;\n      progressbar.innerText = `Image ${percent}%`;\n    });\n\n    xhr.upload.onloadend = () => {\n      progressbar.style.width = `${0}%`;\n      progressbar.innerText = '';\n    };\n\n    let form = event.target;\n    data_ref.current.username = form[0].value;\n    data_ref.current.email = form[1].value;\n    data_ref.current.password = form[2].value;\n    xhr.setRequestHeader('userData', JSON.stringify(data_ref.current));\n    let form_data = new FormData();\n    let imagefile = form[4].files[0];\n    console.log(imagefile);\n    form_data.append('image', imagefile);\n    imagefile ? xhr.send(form_data) : xhr.send();\n  };\n\n  var input_id;\n  var prev_value;\n\n  function change_image() {\n    try {\n      if (ref.current['image_input'].value !== '' && ref.current['image_input'].value !== prev_value) {\n        if (ref.current['image_input'].files[0].size >= 10485760) {\n          alert(\"**File size must be under 10MB**\");\n          ref.current['image_input'].value = \"\";\n          ref.current['image'].style.backgroundImage = `none`;\n        } else {\n          try {\n            let image_url = URL.createObjectURL(ref.current['image_input'].files[0]);\n            ref.current['image'].style.backgroundImage = `url(${image_url})`;\n          } catch (e) {\n            console.log(e);\n          }\n\n          prev_value = ref.current['image_input'].value;\n          clearInterval(input_id);\n        }\n      }\n    } catch (e) {}\n  }\n\n  const check_otp = useCallback(event => {\n    let form = event.target;\n    let otp_input = form[0];\n\n    if (otp_input.value.length !== 4) {\n      otp_input.focus();\n      otp_input.setCustomValidity('OTP must be of 4 digits!!!');\n      otp_input.reportValidity();\n      return;\n    } else {\n      otp_input.setCustomValidity('');\n      otp_input.reportValidity();\n    }\n\n    let xhr = new XMLHttpRequest();\n    props.appbodyloading('flex');\n    xhr.open('POST', origin + 'backend_api/verifyotp');\n\n    xhr.onreadystatechange = () => {\n      if (xhr.status === 200 && xhr.readyState === 4) {\n        let response = JSON.parse(xhr.response);\n        console.log(response);\n\n        if (response.status === 'fail') {\n          otp_input.focus();\n          otp_input.setCustomValidity('âš ï¸ Wrong OTPâš ï¸ Signup Again!!! ');\n          otp_input.reportValidity();\n          setTimeout(() => {\n            set_block_state('form');\n            set_refs();\n          }, 2000);\n          props.appbodyloading('none');\n        } else if (response.staus === 'success') {\n          set_block_state('success');\n          props.appbodyloading('none');\n        }\n      }\n    };\n\n    xhr.onerror = () => {\n      alert(\"Too Slow connection!!\\n try with smaller size Photo\");\n      props.appbodyloading('none');\n      set_block_state('otp');\n    };\n\n    xhr.setRequestHeader('otp', otp_input.value);\n    xhr.setRequestHeader('email', data_ref.current.email);\n    xhr.send();\n  }, [data_ref]);\n\n  let form_block = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"signup_heading\",\n      ref: el => ref.current['signup_heading'] = el,\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: \"javascript:void(0);\",\n      onSubmit: event => submit_data(event),\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        required: true,\n        type: \"text\",\n        placeholder: \"Username\",\n        className: \"signup_username\",\n        ref: el => ref.current['username'] = el,\n        maxLength: 100,\n        onInput: event => checkUsername(event)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        required: true,\n        type: \"email\",\n        placeholder: \"Email\",\n        className: \"signup_email\",\n        ref: el => ref.current['email'] = el,\n        maxLength: 100,\n        onInput: e => removequotes(e)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        required: true,\n        type: \"password\",\n        placeholder: \"Password\",\n        className: \"signup_password\",\n        ref: el => ref.current['password'] = el,\n        minLength: 8,\n        onInput: e => removequotes(e)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\",\n        id: \"signup_submit\",\n        value: \"Sign Up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"upload_image\",\n        ref: el => ref.current['image'] = el,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          id: \"file_input\",\n          ref: el => ref.current['image_input'] = el,\n          accept: \"image/*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file_input\",\n          id: \"file_input_label\",\n          ref: el => ref.current['image_percent'] = el,\n          onClick: () => input_id = setInterval(change_image, 2000),\n          children: \"100%\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n\n  let otp_block = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"signup_heading\",\n      ref: el => ref.current['signup_heading'] = el,\n      align: \"center\",\n      style: {\n        color: 'rgb(24, 151, 201)'\n      },\n      children: \"OTP\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: 'javascript:void(0);',\n      onSubmit: event => {\n        set_block_state('otp');\n        check_otp(event);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        required: true,\n        type: \"number\",\n        ref: el => ref.current['otp_input'] = el,\n        className: \"signup_password\",\n        onInput: e => {\n          e.target.value.length > 4 ? e.target.setCustomValidity('No More than 4 Digits') : e.target.setCustomValidity('');\n          e.target.reportValidity();\n        },\n        style: {\n          gridColumn: '1 / span 2',\n          gridRow: '1 / span 2',\n          marginRight: '20px',\n          marginLeft: '20px',\n          fontSize: '30px',\n          letterSpacing: '32px',\n          color: \"#0334dd\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"instList\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Check Email for OTP\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Must have 4 digits\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Email is identity\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\",\n        id: \"signup_submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n\n  let error_block = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"signup_heading\",\n      ref: el => ref.current['signup_heading'] = el,\n      align: \"center\",\n      style: {\n        color: 'rgb(24, 151, 201)'\n      },\n      children: \"Error Occured!!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"signup_submit\",\n      onClick: () => {\n        set_block_state('form');\n        setTimeout(() => set_refs(), 500);\n      },\n      style: {\n        justifySelf: 'center',\n        gridColumn: '1/span 2',\n        cursor: 'pointer'\n      },\n      children: \"Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n\n  let success_block = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      ref: el => ref.current['signup_heading'] = el,\n      style: {\n        color: 'rgb(24, 151, 201)',\n        gridColumn: '1/ span 2'\n      },\n      align: \"center\",\n      children: \"\\uD83C\\uDF89Welcome\\uD83C\\uDF89\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"signup_submit\",\n      style: {\n        justifySelf: 'center',\n        gridColumn: '1/span 2',\n        cursor: 'pointer'\n      },\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        style: {\n          textDecoration: 'none'\n        },\n        to: \"/Login\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 175\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 119\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 14\n    }, this)]\n  }, void 0, true);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"signup\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"signup_form\",\n      ref: el => ref.current['signup_form'] = el,\n      children: [block_state === 'form' ? form_block : null, block_state === 'otp' ? otp_block : null, block_state === 'error' ? error_block : null, block_state === 'success' ? success_block : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"progress signup_heading\",\n      id: \"progressbar\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 269,\n    columnNumber: 7\n  }, this);\n};\n\n_s(AppSignup, \"R6d4d5B1QhRYKEuUfhyT5DV0DqQ=\");\n\n_c = AppSignup;\nexport default AppSignup;\n\nvar _c;\n\n$RefreshReg$(_c, \"AppSignup\");","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/src/componenets/appSignup.js"],"names":["useState","useRef","useEffect","useCallback","Link","appConfig","anime","AppSignup","props","chars","checkUsername","event","preventDefault","filtered_list","target","value","filter","item","list","join","setCustomValidity","nativeEvent","data","slice","length","reportValidity","removequotes","ref","targets","current","update","style","progress","err","duration","autoplay","direction","loop","set_refs","console","log","block_state","backgroundImage","signup_background","username","password","email","uplaod_background_image","set_block_state","origin","data_ref","submit_data","xhr","XMLHttpRequest","appbodyloading","onreadystatechange","status","readyState","response","JSON","parse","focus","open","progressbar","document","getElementById","upload","addEventListener","percent","Math","round","loaded","total","width","innerText","onloadend","form","setRequestHeader","stringify","form_data","FormData","imagefile","files","append","send","input_id","prev_value","change_image","size","alert","image_url","URL","createObjectURL","e","clearInterval","check_otp","otp_input","setTimeout","staus","onerror","form_block","el","setInterval","otp_block","color","gridColumn","gridRow","marginRight","marginLeft","fontSize","letterSpacing","error_block","justifySelf","cursor","success_block","textDecoration"],"mappings":"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","sourcesContent":["import './statics/css/appSignup.css'\r\nimport {useState,useRef , useEffect, useCallback} from 'react'\r\nimport username from './statics/images/username.svg'\r\nimport password from './statics/images/password.svg'\r\nimport email from './statics/images/email.svg'\r\nimport uplaod_background_image from './statics/images/upload_image_background.svg'\r\nimport signup_background from './statics/images/signup_background.svg'\r\nimport { Link } from 'react-router-dom'\r\nimport appConfig from './statics/appConfig.json'\r\n\r\nimport anime from 'animejs'\r\n\r\n\r\nvar AppSignup = props=>{\r\n\r\n\r\n    let chars = {\"!\":null , \"#\":null , \"$\":null,\"%\":null,\"^\":null,\"&\":null,\"*\":null,\"(\":null,\")\":null,\"'\":null, '\"':null,\";\":null, \":\":null}\r\n\r\n\r\n    function checkUsername(event) {\r\n        event.preventDefault()\r\n        let filtered_list = [...event.target.value].filter((item)=> !(item in chars))\r\n        let list = [...event.target.value]\r\n\r\n        if( filtered_list.join('') == list.join('') ){\r\n                event.target.setCustomValidity(\"\")\r\n            }\r\n\r\n        else if (event.nativeEvent.data === '\"' || event.nativeEvent.data === \"'\"){\r\n            event.target.value = event.target.value.slice(0, event.target.value.length-1)\r\n        }else if (event.nativeEvent.data in chars ){\r\n            event.target.setCustomValidity(\"username should not contain \\n ------------ ?!:;\\\"'#$%^&*() ------------\")\r\n            event.target.reportValidity()\r\n            \r\n        }\r\n    }\r\n\r\n    function removequotes(event){\r\n        if (event.nativeEvent.data === '\"' || event.nativeEvent.data === \"'\"){\r\n            event.target.value = event.target.value.slice(0, event.target.value.length-1)\r\n            event.target.setCustomValidity('Cannot use \" or \\' ')\r\n            event.target.reportValidity()\r\n        }else{\r\n            event.target.setCustomValidity('')\r\n            \r\n        }\r\n    }\r\n\r\n    const ref = useRef({})\r\n\r\n\r\n\r\n    // useEffect for ref\r\n    useEffect(()=>{\r\ntry{\r\n    anime({\r\n        targets:ref.current['signup_heading'],\r\n        update:function(anime){\r\n            try{\r\n            ref.current['signup_heading'].style.filter = `hue-rotate(${anime.progress *3.6}deg)`\r\n            }catch(err){\r\n                \r\n            }\r\n        },\r\n        duration:2000,\r\n        autoplay:true,\r\n        direction:'alternate',\r\n        loop:true\r\n    })\r\n        set_refs()\r\n    }catch(err){\r\n        console.log(err)\r\n    }\r\n\r\n    }, [ref, block_state])\r\n\r\n    let set_refs = ()=>{\r\n        ref.current['signup_form'].style.backgroundImage = `url(${signup_background})`\r\n        ref.current['username'].style.backgroundImage = `url(${username})`\r\n        ref.current['password'].style.backgroundImage = `url(${password})`\r\n        ref.current['email'].style.backgroundImage = `url(${email})`\r\n        ref.current['image'].style.backgroundImage = `url(${uplaod_background_image})`\r\n\r\n\r\n    }\r\n\r\n    var [block_state, set_block_state] = useState('form')\r\n\r\n    const origin = appConfig.origin\r\n    const data_ref = useRef({});\r\n\r\n    let submit_data=(event)=>{\r\n        \r\n        let xhr = new XMLHttpRequest()\r\n        props.appbodyloading('flex')\r\n        xhr.onreadystatechange = ()=>{\r\n            console.log(xhr.status, xhr.readyState)\r\n            if (xhr.status === 200 && xhr.readyState ===4){\r\n                let response = JSON.parse(xhr.response)\r\n                console.log(response)\r\n                \r\n                if(response.status === \"exists\"){\r\n                        ref.current['email'].focus()\r\n                        ref.current['email'].setCustomValidity('This Email Exists!!!')\r\n                        ref.current['email'].reportValidity()\r\n                        props.appbodyloading('none')\r\n\r\n                    }\r\n                    else if(response.status === \"otp\"){\r\n                        set_block_state(\"otp\")\r\n                        ref.current['otp_input'].style.backgroundImage = `url(${password})`\r\n                        props.appbodyloading('none')\r\n                        \r\n                    }\r\n                    else if(response.status === \"fail\"){\r\n                        set_block_state(\"error\")\r\n                        props.appbodyloading('none')\r\n\r\n                    }\r\n                }\r\n            }\r\n        \r\n        \r\n        \r\n        xhr.open('POST',origin+'backend_api/signup')\r\n        let progressbar = document.getElementById('progressbar')\r\n        xhr.upload.addEventListener('progress',(event)=>{\r\n            let percent = Math.round( (event.loaded/event.total)*100)\r\n            progressbar.style.width = `${percent}%`\r\n            progressbar.innerText = `Image ${percent}%`\r\n        })\r\n        xhr.upload.onloadend = ()=>{\r\n            progressbar.style.width = `${0}%`\r\n            progressbar.innerText = ''\r\n        }\r\n\r\n        let form = event.target\r\n        data_ref.current.username = form[0].value\r\n        data_ref.current.email    = form[1].value\r\n        data_ref.current.password = form[2].value\r\n              \r\n        xhr.setRequestHeader('userData' , JSON.stringify(data_ref.current))\r\n\r\n        let form_data = new FormData()\r\n        let imagefile = form[4].files[0]\r\n        console.log(imagefile)\r\n        form_data.append('image' , imagefile)\r\n        imagefile?\r\n        xhr.send(form_data)\r\n        :xhr.send()\r\n            }\r\n\r\n    \r\n    var input_id\r\n    var prev_value\r\n    function change_image(){\r\n        try{\r\n        if (ref.current['image_input'].value !== '' && ref.current['image_input'].value !== prev_value ){\r\n            if (ref.current['image_input'].files[0].size >= 10485760){\r\n                alert(\"**File size must be under 10MB**\")\r\n                ref.current['image_input'].value = \"\"\r\n                ref.current['image'].style.backgroundImage = `none`\r\n            }else{\r\n            try{let image_url = URL.createObjectURL( ref.current['image_input'].files[0])\r\n            ref.current['image'].style.backgroundImage = `url(${image_url})`}catch(e){console.log(e)}\r\n            prev_value = ref.current['image_input'].value\r\n            clearInterval(input_id)\r\n            }\r\n    }}catch(e){}\r\n    }\r\n\r\n    const check_otp = useCallback((event)=>{\r\n        let form = event.target\r\n        let otp_input = form[0]\r\n        if(otp_input.value.length !== 4){\r\n            otp_input.focus()\r\n            otp_input.setCustomValidity('OTP must be of 4 digits!!!')\r\n            otp_input.reportValidity()\r\n            return\r\n        }else{ \r\n            otp_input.setCustomValidity('')\r\n            otp_input.reportValidity()\r\n        }\r\n        let xhr = new XMLHttpRequest()\r\n        props.appbodyloading('flex')\r\n\r\n        xhr.open( 'POST', origin+'backend_api/verifyotp' )\r\n        xhr.onreadystatechange = ()=>{\r\n            if(xhr.status === 200 && xhr.readyState === 4){\r\n                let response = JSON.parse(xhr.response)\r\n                console.log(response)\r\n                \r\n                if(response.status === 'fail'){\r\n                    otp_input.focus()\r\n                    otp_input.setCustomValidity('âš ï¸ Wrong OTPâš ï¸ Signup Again!!! ')\r\n                    otp_input.reportValidity()\r\n                    setTimeout(()=>{set_block_state('form');set_refs()},2000)\r\n                    props.appbodyloading('none')\r\n\r\n                }else if (response.staus === 'success'){\r\n                    set_block_state('success')\r\n                    props.appbodyloading('none')\r\n\r\n                }\r\n            }\r\n        }\r\n        xhr.onerror=()=>{\r\n            alert(\"Too Slow connection!!\\n try with smaller size Photo\")\r\n            props.appbodyloading('none')\r\n            set_block_state('otp')\r\n        }\r\n\r\n        xhr.setRequestHeader('otp' , otp_input.value)\r\n        xhr.setRequestHeader('email' , data_ref.current.email)\r\n        xhr.send()\r\n        \r\n    },[data_ref])\r\n\r\n    let form_block = (<>\r\n        <h1 className = \"signup_heading\" ref = {el=>ref.current['signup_heading']=el} >Sign Up</h1>\r\n        <form action=\"javascript:void(0);\" onSubmit = {event=>submit_data(event)}>\r\n            <input required = {true} type=\"text\" placeholder = 'Username' className= 'signup_username' ref = {el => ref.current['username']= el} maxLength={100} onInput= {event=>checkUsername(event)} />\r\n            <input required = {true} type= \"email\" placeholder = 'Email' className= \"signup_email\"  ref = {el => ref.current['email']= el}  maxLength={100} onInput= {e=>removequotes(e)} />\r\n            <input required = {true} type=\"password\" placeholder = 'Password' className= 'signup_password'  ref = {el => ref.current['password']= el}  minLength={8} onInput={e=>removequotes(e)}  />\r\n            <input type=\"submit\" id = \"signup_submit\" value=\"Sign Up\" />\r\n            <div className=\"upload_image\" ref = {el => ref.current['image']=el} >\r\n                <input type=\"file\"  id = 'file_input'  ref = {el=>ref.current['image_input']=el}  accept= \"image/*\"  />\r\n                <label htmlFor= \"file_input\" id = \"file_input_label\" ref = {el=>ref.current['image_percent']= el}  onClick={()=>input_id = setInterval(change_image, 2000)}  >100%</label>\r\n            </div>\r\n        </form>\r\n        </>)\r\n\r\n\r\n    let otp_block = (<>\r\n        <h1 className = \"signup_heading\" ref = {el=>ref.current['signup_heading']=el} align='center' style = {{color:'rgb(24, 151, 201)'}} > \r\n        OTP\r\n        </h1>\r\n        <form action= {'javascript:void(0);'} onSubmit = {event =>{set_block_state('otp') ;check_otp(event)}} >\r\n            <input required = {true} type=\"number\" ref= {el=>ref.current['otp_input']=el} className = \"signup_password\"   onInput= {(e)=>{e.target.value.length>4?\r\n                e.target.setCustomValidity('No More than 4 Digits')\r\n                :e.target.setCustomValidity('')\r\n                e.target.reportValidity()\r\n                }} style = {{gridColumn:'1 / span 2',gridRow:'1 / span 2' , marginRight:'20px', marginLeft : '20px',fontSize:'30px', letterSpacing:'32px', color:\"#0334dd\" }} />\r\n\r\n            <ul className = 'instList'>\r\n                <li>Check Email for OTP</li>\r\n                <li>Must have 4 digits</li>\r\n                <li>Email is identity</li>\r\n            </ul>\r\n            <input type=\"submit\" id = \"signup_submit\"  />\r\n        </form>\r\n        </>)\r\n\r\n    let error_block = ( <>\r\n        <h2 className = \"signup_heading\" ref = {el=>ref.current['signup_heading']=el} align='center' style = {{color:'rgb(24, 151, 201)'}} >Error Occured!!</h2>\r\n        <button id = \"signup_submit\" onClick= {()=>{set_block_state('form')\r\n    setTimeout(()=>set_refs(),500)\r\n    }} style = {{justifySelf:'center',  gridColumn: '1/span 2', cursor:'pointer'}}>Back</button>\r\n        </>)\r\n\r\n        let success_block = (<>\r\n            <h3 ref = {el=>ref.current['signup_heading']=el} style = {{color:'rgb(24, 151, 201)', gridColumn:'1/ span 2'}}  align='center'>ðŸŽ‰WelcomeðŸŽ‰</h3>\r\n             <button id = \"signup_submit\"  style = {{justifySelf:'center',  gridColumn: '1/span 2',cursor:'pointer'}}><Link style  = {{textDecoration:'none'}} to  = \"/Login\"><span>Login</span></Link></button>\r\n            \r\n            </>)\r\n\r\n \r\n    return(\r\n      <div className=\"signup\">\r\n          <div className=\"signup_form\"  ref = {el=>ref.current['signup_form']=el}>\r\n            { block_state==='form'?form_block\r\n                : null}\r\n            {block_state === 'otp'?otp_block\r\n            :null}\r\n            {block_state==='error'?error_block\r\n            :null\r\n            }\r\n            {block_state==='success'?success_block\r\n        :null}\r\n                \r\n          </div>\r\n          <div className=\"progress signup_heading\" id = 'progressbar'></div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default AppSignup"]},"metadata":{},"sourceType":"module"}