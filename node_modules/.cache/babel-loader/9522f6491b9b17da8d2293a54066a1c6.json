{"ast":null,"code":"var _jsxFileName = \"D:\\\\Python files\\\\Start Django\\\\blog_tube\\\\frontend\\\\blog_tube\\\\src\\\\componenets\\\\appBlog.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nimport { useContext, useEffect, useState, useRef, useCallback, useMemo } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { Blog } from \"./appUploadBlog\";\nimport { BlogiansMiniProfile } from \"./appBlogians\";\nimport { Helmet } from 'react-helmet';\nimport DOMPurify from 'dompurify';\nimport appConfig from './statics/appConfig.json';\nimport './statics/css/appUploadBlog.css';\nimport './statics/css/appBlog.css';\nimport view_logo from \"./statics/images/preview.svg\";\nimport like_logo from \"./statics/images/like.svg\";\nimport dislike_logo from \"./statics/images/dislike.svg\";\nimport { Login_context } from \"../App\";\nimport UserImage from \"./userImage\";\nimport { logout } from \"./statics/utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AppBlog = props => {\n  _s();\n\n  const url = window.location.hash.split(\"?\")[1];\n  const blog_id = url.split(\"=\")[1];\n  const history = useHistory();\n\n  if (blog_id === null) {\n    history.push('/Error');\n  }\n\n  const [blog_data_list, set_blog_data_list] = useState([]);\n  const [blog_details, set_blog_details] = useState({\n    likes: \"\",\n    dislikes: \"\",\n    views: \"\",\n    title: \"\",\n    image_url: \"\",\n    discription: \"\",\n    blogger_details: {}\n  });\n  const ref = useRef({});\n  useEffect(() => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', appConfig.origin + 'backend_api/getBlog?blog_id=' + blog_id);\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        let response = JSON.parse(xhr.response);\n\n        switch (response.status) {\n          case \"success\":\n            set_blog_data_list(response.blog);\n            set_blog_details({\n              likes: response.likes,\n              dislikes: response.dislikes,\n              views: response.views,\n              title: response.title,\n              image_url: response.image_url,\n              blogger_details: response.blogger_details\n            });\n            break;\n\n          case \"page_not_found\":\n            history.push('/Error');\n            break;\n\n          case \"fail\":\n            history.push('/Error');\n            break;\n\n          default:\n            break;\n        }\n      }\n    };\n\n    xhr.send();\n  }, [blog_id, history]);\n  useEffect(() => {\n    let ele = document.getElementsByClassName(\"appbody\")[0];\n    ele.scrollTo(0, 0);\n  }, [blog_details]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"blog_page\",\n    ref: el => ref.current.blog_page = el,\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: blog_details.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"Description\",\n        content: blog_details.discription\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      align: \"center\",\n      children: blog_details.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: blog_details.image_url,\n      alt: \"title\",\n      className: \"title_image\",\n      loading: \"eager\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(BlogiansMiniProfile, {\n      user_details: blog_details.blogger_details,\n      onClick: () => null,\n      to: `/Profile/${blog_details.blogger_details.user_id}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Blog, {\n      children: blog_data_list.map((item, index) => /*#__PURE__*/_jsxDEV(DataContainer, {\n        data: item\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 48\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ReviewBlog, {\n      blog_id: blog_id,\n      likes: blog_details.likes,\n      dislikes: blog_details.dislikes,\n      views: blog_details.views\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Comments, {\n      blog_id: blog_id,\n      appbodyloading: props.appbodyloading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 12\n  }, this);\n};\n\n_s(AppBlog, \"HGPCUDN5f9fLlU2U9Qd3iSPmw5I=\", false, function () {\n  return [useHistory];\n});\n\n_c = AppBlog;\nexport default AppBlog;\n\nconst DataContainer = props => {\n  _s2();\n\n  const ref = useRef();\n  useEffect(() => {\n    let sanitized_data = DOMPurify.sanitize(props.data, {\n      ADD_TAGS: ['iframe'],\n      ADD_ATTR: [\"allow\", \"allowfullscreen\", 'frameborder', 'scrolling']\n    });\n    ref.current.innerHTML = sanitized_data;\n  }, [ref, props.data]);\n  return /*#__PURE__*/_jsxDEV(\"iframe\", {\n    srcDoc: \"https://twitframe.com/show?url=https://twitter.com/MadhavSheth1/status/1448506389421191170\",\n    onLoad: e => setTimeout(() => {\n      const obj = ReactDOM.findDOMNode(this);\n      obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';\n    }, 50)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 13\n  }, this) // <div ref={el=>ref.current=el} className = \"container_data\"  >\n  //     </div>\n  ;\n};\n\n_s2(DataContainer, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n\n_c2 = DataContainer;\n\nconst ReviewBlog = props => {\n  _s3();\n\n  const session_id = useContext(Login_context);\n  const history = useHistory();\n  const [reviewed, set_reviewed] = useState(\"not yet\");\n  const [reviews, set_reviews] = useState({\n    likes: props.likes,\n    dislikes: props.dislikes,\n    views: props.views\n  });\n  const ref = useRef({});\n  useEffect(() => {\n    set_reviews({\n      likes: props.likes,\n      dislikes: props.dislikes,\n      views: props.views\n    });\n  }, [props.likes, props.dislikes, props.views]);\n  const review = useCallback(event => {\n    let opt = event.target.value;\n\n    if (session_id === sessionStorage.session) {\n      let xhr = new XMLHttpRequest();\n      let uid = JSON.parse(sessionStorage.login_data).user_id;\n      xhr.open('POST', appConfig.origin + `backend_api/Blogreview`);\n\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          let response = JSON.parse(xhr.response);\n\n          if (response.status === \"success\") {\n            set_reviews({ ...response.details\n            });\n          }\n        }\n      };\n\n      let formdata = new FormData();\n      formdata.append('uid', uid);\n      formdata.append('bid', props.blog_id);\n      formdata.append('review', opt);\n      xhr.send(formdata);\n    } else {\n      history.push('/Error');\n    }\n  }, [session_id, props.blog_id, history]);\n  useEffect(() => {\n    if (session_id === sessionStorage.session && Boolean(session_id) && Boolean(sessionStorage.session)) {\n      let xhr = new XMLHttpRequest();\n      let uid = JSON.parse(sessionStorage.login_data).user_id;\n      xhr.open('GET', appConfig.origin + `backend_api/checkReviewr?bid=${props.blog_id}&uid=${uid}`);\n\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          let response = JSON.parse(xhr.response);\n\n          if (response.status === \"success\") {\n            set_reviewed(response.isreviewer);\n          }\n        }\n      };\n\n      xhr.send();\n    }\n  }, [session_id, props.blog_id]);\n  useEffect(() => {\n    if (reviewed === \"like\") {\n      ref.current.like.click();\n    } else if (reviewed === \"dislike\") {\n      ref.current.dislike.click();\n    }\n  }, [reviewed]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"review\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"radio\",\n      name: \"review\",\n      ref: el => ref.current.like = el,\n      id: \"like\",\n      value: \"like\",\n      onInput: e => review(e),\n      disabled: !session_id,\n      hidden: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"like\",\n      id: \"like_label\",\n      style: {\n        backgroundImage: `url(${like_logo})`\n      },\n      children: reviews.likes > 0 ? reviews.likes : \"No Likes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      id: \"view_label\",\n      style: {\n        backgroundImage: `url(${view_logo})`\n      },\n      children: reviews.views > 0 ? reviews.views : \"No Views\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"radio\",\n      name: \"review\",\n      ref: el => ref.current.dislike = el,\n      id: \"dislike\",\n      value: \"dislike\",\n      onInput: e => review(e),\n      disabled: !session_id,\n      hidden: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"dislike\",\n      id: \"dislike_label\",\n      style: {\n        backgroundImage: `url(${dislike_logo})`\n      },\n      children: reviews.dislikes > 0 ? reviews.dislikes : \"No Dislikes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 162,\n    columnNumber: 9\n  }, this);\n};\n\n_s3(ReviewBlog, \"3lB+DIlRqtmkHG+jrMr0DcyegDE=\", false, function () {\n  return [useHistory];\n});\n\n_c3 = ReviewBlog;\n\nconst Comments = props => {\n  _s4();\n\n  let session_id = useContext(Login_context);\n  const ref = useRef({});\n  const [login_status, set_login_status] = useState(false);\n  const history = useHistory();\n  useEffect(() => {\n    if (session_id === sessionStorage.session && Boolean(session_id) && Boolean(sessionStorage.session)) {\n      set_login_status(true);\n    } else {\n      set_login_status(false);\n    }\n  }, [session_id]);\n  const [comment_list, set_comment_list] = useState([]);\n  const update_comments = useCallback(() => {\n    let xhr = new XMLHttpRequest();\n    xhr.open('POST', appConfig.origin + `backend_api/getComments`);\n\n    xhr.onreadystatechange = () => {\n      if (xhr.status === 200 && xhr.readyState === 4) {\n        let response = JSON.parse(xhr.response);\n\n        switch (response.status) {\n          case \"success\":\n            set_comment_list(response.comment_list);\n            break;\n\n          case \"loginRequired\":\n            console.log(`backend_api/getComments`);\n            logout();\n            history.push(\"/Login\");\n            break;\n\n          default:\n            console.log(response.status);\n            break;\n        }\n      }\n    };\n\n    let formdata = new FormData();\n    formdata.append('blog_id', props.blog_id);\n    xhr.send(formdata);\n  }, [comment_list, ref, history, props.blog_id]);\n  useEffect(() => {\n    update_comments();\n  }, [props.blog_id]);\n  useEffect(() => ref.current.comment_list.scrollTo(0, 0), [comment_list, ref]);\n  const send_comment = useCallback(() => {\n    let comment = ref.current.comment_input.value;\n\n    if (session_id === sessionStorage.session && comment !== '') {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", appConfig.origin + `backend_api/uploadComment`);\n      props.appbodyloading('flex');\n\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          let response = JSON.parse(xhr.response);\n          ref.current.comment_input.value = '';\n\n          switch (response.status) {\n            case \"success\":\n              console.log(response);\n              update_comments();\n              props.appbodyloading('none');\n              break;\n\n            case \"loginRequired\":\n              console.log(response.status);\n              logout();\n              history.push(\"/Login\");\n              props.appbodyloading('none');\n              break;\n\n            case \"fail\":\n              console.log(response.status);\n              history.push(\"/Error\");\n              props.appbodyloading('none');\n              break;\n\n            default:\n              console.log(response.status);\n              props.appbodyloading('none');\n              break;\n            // list has to be updated here\n          }\n        }\n      };\n\n      const formdata = new FormData();\n      xhr.setRequestHeader(\"session\", session_id);\n      formdata.append(\"comment\", comment);\n      formdata.append(\"user_id\", JSON.parse(sessionStorage.login_data).user_id);\n      formdata.append(\"blog_id\", props.blog_id);\n      xhr.send(formdata);\n    }\n  }, [session_id, ref, props]);\n  const cList = useMemo(() => comment_list.map(item => /*#__PURE__*/_jsxDEV(Comment, {\n    c_detials: item\n  }, item.cid, false, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 56\n  }, this)));\n  const nList = useMemo(() => /*#__PURE__*/_jsxDEV(\"span\", {\n    style: {\n      display: \"grid\",\n      placeItems: \"center\",\n      fontSize: \"30px\",\n      width: \"100%\",\n      height: \"100%\"\n    },\n    id: \"no_comments\",\n    children: \"No Comments\\uD83D\\uDE05\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 261,\n    columnNumber: 32\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"comments\",\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      align: \"center\",\n      children: \"Comments\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cover\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"comment\",\n        maxLength: 1000,\n        id: \"comment_input\",\n        disabled: !login_status,\n        ref: el => ref.current.comment_input = el,\n        cols: \"3\",\n        rows: \"5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        ref: el => ref.current.send_comment = el,\n        disabled: !login_status,\n        id: \"send_comment\",\n        onClick: () => send_comment()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment_list\",\n      ref: el => ref.current.comment_list = el,\n      children: comment_list.length === 0 ? nList : cList\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 12\n  }, this);\n};\n\n_s4(Comments, \"k05ZuaI2AJ2lScF8Q9EEeRuObQY=\", false, function () {\n  return [useHistory];\n});\n\n_c4 = Comments;\n\nconst Comment = props => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"comment\",\n    id: props.key,\n    children: [/*#__PURE__*/_jsxDEV(UserImage, {\n      user_id: props.c_detials.uid,\n      width: \"50px\",\n      height: \"50px\",\n      style: {\n        gridArea: \"user_image\",\n        borderWidth: \"2px\",\n        alignSelf: \"center\",\n        justifySelf: \"center\"\n      },\n      to: `/Profile/${props.c_detials.uid}`,\n      onClick: () => null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      id: \"user_name\",\n      children: props.c_detials.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"comment_text\",\n      style: {\n        whiteSpace: \"break-spaces\"\n      },\n      children: props.c_detials.text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"datetime\",\n      children: props.c_detials.upload_datetime\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 282,\n    columnNumber: 9\n  }, this);\n};\n\n_c5 = Comment;\nexport { Comment };\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"AppBlog\");\n$RefreshReg$(_c2, \"DataContainer\");\n$RefreshReg$(_c3, \"ReviewBlog\");\n$RefreshReg$(_c4, \"Comments\");\n$RefreshReg$(_c5, \"Comment\");","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/src/componenets/appBlog.js"],"names":["useContext","useEffect","useState","useRef","useCallback","useMemo","useHistory","Blog","BlogiansMiniProfile","Helmet","DOMPurify","appConfig","Login_context","UserImage","logout","AppBlog","props","url","window","location","hash","split","blog_id","history","push","blog_data_list","set_blog_data_list","blog_details","set_blog_details","likes","dislikes","views","title","image_url","discription","blogger_details","ref","xhr","XMLHttpRequest","open","origin","onreadystatechange","readyState","status","response","JSON","parse","blog","send","ele","document","getElementsByClassName","scrollTo","el","current","blog_page","user_id","map","item","index","appbodyloading","DataContainer","sanitized_data","sanitize","data","ADD_TAGS","ADD_ATTR","innerHTML","e","setTimeout","obj","ReactDOM","findDOMNode","style","height","contentWindow","body","scrollHeight","ReviewBlog","session_id","reviewed","set_reviewed","reviews","set_reviews","review","event","opt","target","value","sessionStorage","session","uid","login_data","details","formdata","FormData","append","Boolean","isreviewer","like","click","dislike","backgroundImage","like_logo","view_logo","dislike_logo","Comments","login_status","set_login_status","comment_list","set_comment_list","update_comments","console","log","send_comment","comment","comment_input","setRequestHeader","cList","cid","nList","display","placeItems","fontSize","width","length","Comment","key","c_detials","gridArea","borderWidth","alignSelf","justifySelf","name","whiteSpace","text","upload_datetime"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState ,useRef, useCallback, useMemo} from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Blog } from \"./appUploadBlog\";\r\nimport { BlogiansMiniProfile } from \"./appBlogians\";\r\nimport {Helmet} from 'react-helmet'\r\nimport DOMPurify from 'dompurify'\r\nimport appConfig from './statics/appConfig.json'\r\nimport './statics/css/appUploadBlog.css'\r\nimport './statics/css/appBlog.css'\r\nimport view_logo from './statics/images/preview.svg'\r\nimport like_logo from './statics/images/like.svg'\r\nimport dislike_logo from './statics/images/dislike.svg'\r\nimport { Login_context } from \"../App\";\r\nimport UserImage from \"./userImage\";\r\nimport { logout } from \"./statics/utils\";\r\n\r\nconst AppBlog  = props=>{\r\n    const url = window.location.hash.split(\"?\")[1]\r\n    const blog_id = url.split(\"=\")[1]\r\n    const history = useHistory()\r\n    if (blog_id === null){\r\n        history.push('/Error')\r\n    }\r\n\r\n    const [blog_data_list , set_blog_data_list] = useState([])\r\n    const [blog_details , set_blog_details] = useState({likes:\"\" , dislikes:\"\" ,\r\n     views :\"\" , title:\"\" , image_url:\"\",discription:\"\",blogger_details:{}})\r\n\r\n     const ref = useRef({})\r\n    useEffect(()=>{\r\n    const xhr = new XMLHttpRequest()\r\n    xhr.open('GET' ,appConfig.origin+'backend_api/getBlog?blog_id='+blog_id )\r\n    xhr.onreadystatechange =()=>{\r\n        if (xhr.readyState === 4 && xhr.status === 200){\r\n            let response = JSON.parse(xhr.response)\r\n            switch (response.status){\r\n                case \"success\":\r\n                    set_blog_data_list(response.blog)\r\n                    set_blog_details({likes:response.likes ,\r\n                                      dislikes:response.dislikes ,\r\n                                    views:response.views ,\r\n                                title :response.title ,\r\n                            image_url:response.image_url,\r\n                                blogger_details : response.blogger_details})\r\n                    break;\r\n                case \"page_not_found\":\r\n                    history.push('/Error')\r\n                    break;\r\n                case \"fail\":\r\n                    history.push('/Error')\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    xhr.send()\r\n\r\n    },[blog_id , history])\r\n\r\n\r\n    useEffect(()=>{\r\n        let ele  = document.getElementsByClassName(\"appbody\")[0]\r\n        ele.scrollTo(0,0)\r\n    },[blog_details])\r\n\r\n    return(<div  className = \"blog_page\" ref ={el=>ref.current.blog_page = el}  >\r\n        <Helmet>\r\n            <title>{blog_details.title}</title>\r\n            <meta name=\"Description\" content = {blog_details.discription} />\r\n        </Helmet>\r\n        <h2 align = \"center\">{blog_details.title}</h2>\r\n        <img src = {blog_details.image_url} alt=\"title\" className = \"title_image\" loading = {\"eager\"} />\r\n        <BlogiansMiniProfile user_details = {blog_details.blogger_details} onClick={()=>null}  to ={`/Profile/${blog_details.blogger_details.user_id}`} />\r\n        <Blog>\r\n            {blog_data_list.map((item,index)=>(<DataContainer key = {index} data = {item}  /> ))}\r\n        </Blog>\r\n        <ReviewBlog blog_id = {blog_id} likes = {blog_details.likes} dislikes= {blog_details.dislikes} views= {blog_details.views} />\r\n        <Comments  blog_id = {blog_id} appbodyloading={props.appbodyloading} />\r\n    </div>)\r\n}\r\n\r\nexport default AppBlog\r\n\r\nconst DataContainer=props=>{\r\n    const ref = useRef()\r\n    useEffect(()=>{\r\n        let sanitized_data = DOMPurify.sanitize(props.data,\r\n            {ADD_TAGS:['iframe'],ADD_ATTR:[\"allow\" , \"allowfullscreen\",\r\n        'frameborder' , 'scrolling']}\r\n            )\r\n        ref.current.innerHTML = sanitized_data\r\n        \r\n    },[ref,props.data])\r\n    return (<iframe srcDoc=\"https://twitframe.com/show?url=https://twitter.com/MadhavSheth1/status/1448506389421191170\"\r\n    onLoad = {e => setTimeout(() => {\r\n        const obj = ReactDOM.findDOMNode(this);\r\n        obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';\r\n    }, 50)}\r\n    />\r\n    // <div ref={el=>ref.current=el} className = \"container_data\"  >\r\n    //     </div>\r\n        )\r\n}\r\n\r\nconst ReviewBlog=props=>{\r\n    const session_id = useContext(Login_context)\r\n    const history = useHistory()\r\n    const[ reviewed  ,set_reviewed] = useState(\"not yet\")\r\n    const[reviews ,set_reviews] =useState({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    const ref = useRef({})\r\n    useEffect(()=>{\r\n        set_reviews({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    },[props.likes , props.dislikes , props.views])\r\n\r\n    const review=useCallback(event=>{\r\n        let opt = event.target.value\r\n        if (session_id === sessionStorage.session ){\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(sessionStorage.login_data).user_id\r\n            xhr.open('POST' , appConfig.origin+`backend_api/Blogreview`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviews({...response.details})\r\n                }\r\n            }}\r\n            let formdata = new FormData()\r\n            formdata.append('uid' , uid)\r\n            formdata.append('bid' , props.blog_id)\r\n            formdata.append('review' , opt)\r\n            xhr.send(formdata)\r\n        }else{\r\n            history.push('/Error')\r\n        }\r\n    },[session_id,props.blog_id,history ])\r\n    useEffect(()=>{\r\n        if (session_id===sessionStorage.session && (Boolean(session_id) && Boolean(sessionStorage.session))){\r\n\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(sessionStorage.login_data).user_id\r\n            xhr.open('GET' , appConfig.origin+`backend_api/checkReviewr?bid=${props.blog_id}&uid=${uid}`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviewed( response.isreviewer)\r\n                }\r\n            }}\r\n            xhr.send()\r\n        }\r\n    },[session_id,props.blog_id])\r\n    useEffect(()=>{\r\n        if (reviewed === \"like\"){\r\n            ref.current.like.click()\r\n        }else if (reviewed === \"dislike\"){\r\n            ref.current.dislike.click()\r\n        }\r\n    },[reviewed])\r\n\r\n    \r\n    return(\r\n        <div className=\"review\">\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.like = el}  id=\"like\" value= {\"like\"} onInput={e=>review(e)} disabled={!session_id}  hidden/>\r\n            <label htmlFor=\"like\" id=\"like_label\" style={{backgroundImage:`url(${like_logo})`}} >{reviews.likes>0?reviews.likes:\"No Likes\"}</label>\r\n            <label id =\"view_label\" style={{backgroundImage:`url(${view_logo})`}}>{reviews.views>0?reviews.views:\"No Views\"}</label>\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.dislike = el}  id=\"dislike\" value={\"dislike\"} onInput={e=>review(e)} disabled={!session_id} hidden/>\r\n            <label htmlFor=\"dislike\" id=\"dislike_label\" style={{backgroundImage:`url(${dislike_logo})`}}  >{reviews.dislikes>0?reviews.dislikes:\"No Dislikes\"}</label>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Comments =props=>{\r\n    let session_id = useContext(Login_context)\r\n    const ref = useRef({})\r\n    const [login_status , set_login_status] = useState(false)\r\n    const history = useHistory()\r\n    useEffect(()=>{\r\n        if(session_id === sessionStorage.session && (Boolean(session_id) && Boolean(sessionStorage.session))){\r\n            set_login_status(true)\r\n        }else{\r\n            set_login_status(false)\r\n        }\r\n    },[session_id])\r\n\r\n    const [comment_list , set_comment_list] = useState([])\r\n\r\n    const update_comments= useCallback(()=>{\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST' , appConfig.origin+`backend_api/getComments`)\r\n        xhr.onreadystatechange=()=>{\r\n            if(xhr.status===200 && xhr.readyState === 4 ){\r\n                let response = JSON.parse(xhr.response)\r\n                switch (response.status) {\r\n                    case \"success\":\r\n                        set_comment_list(response.comment_list)\r\n                        break;\r\n                    case \"loginRequired\":\r\n                        console.log(`backend_api/getComments`)\r\n                        logout()\r\n                        history.push(\"/Login\")\r\n                        break;\r\n                \r\n                    default:\r\n                        console.log(response.status)\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        let formdata = new FormData()\r\n        formdata.append('blog_id' , props.blog_id)\r\n        xhr.send(formdata)\r\n    },[comment_list,ref, history  , props.blog_id])\r\n\r\n    useEffect(()=>{\r\n        update_comments()\r\n    },[props.blog_id])\r\n    useEffect(()=>ref.current.comment_list.scrollTo(0,0),[comment_list,ref])\r\n\r\n    const send_comment = useCallback(()=>{\r\n        let comment = ref.current.comment_input.value\r\n        if (session_id === sessionStorage.session &&  comment !== ''){\r\n            const xhr = new XMLHttpRequest()\r\n            xhr.open(\"POST\" , appConfig.origin+`backend_api/uploadComment`)\r\n            props.appbodyloading('flex')\r\n            xhr.onreadystatechange = ()=>{\r\n                if(xhr.readyState === 4 && xhr.status === 200){\r\n                let response = JSON.parse(xhr.response) \r\n                ref.current.comment_input.value =''\r\n                switch (response.status) {\r\n                    case \"success\":\r\n                        console.log(response)\r\n                        update_comments()\r\n                        props.appbodyloading('none')\r\n                        break;\r\n                    case \"loginRequired\":\r\n                        console.log(response.status)\r\n                        logout()\r\n                        history.push(\"/Login\")\r\n                        props.appbodyloading('none')\r\n                        break;\r\n                    case \"fail\":\r\n                        console.log(response.status)\r\n                        history.push(\"/Error\") \r\n                        props.appbodyloading('none')\r\n                        break;              \r\n                    default:\r\n                        console.log(response.status)\r\n                        props.appbodyloading('none')\r\n                        break;                                 // list has to be updated here\r\n            }}}\r\n            const formdata = new FormData()\r\n            xhr.setRequestHeader(\"session\" ,session_id )\r\n            formdata.append(\"comment\" , comment)\r\n            formdata.append(\"user_id\"  , JSON.parse(sessionStorage.login_data).user_id)\r\n            formdata.append(\"blog_id\" , props.blog_id)\r\n            xhr.send(formdata)\r\n        }\r\n    \r\n    },[session_id,ref,props])\r\n    const cList = useMemo(()=>(comment_list.map(item=>(<Comment c_detials = {item} key ={item.cid} />))))\r\n    const nList = useMemo(()=>(<span style ={{display:\"grid\",placeItems:\"center\",\r\n    fontSize:\"30px\",width:\"100%\" ,height:\"100%\"}} id = \"no_comments\">No CommentsðŸ˜…</span>))\r\n    return(<div className=\"comments\">\r\n            \r\n                <h5 align = \"center\">Comments</h5>\r\n                <div className=\"cover\">\r\n                <textarea name=\"comment\" maxLength={1000} id=\"comment_input\"  disabled={!login_status}\r\n                ref={el=>ref.current.comment_input = el} cols=\"3\" rows=\"5\">\r\n                </textarea>\r\n                <button ref = {el=>ref.current.send_comment = el} disabled= {!login_status}\r\n                   id=\"send_comment\" onClick = {()=>send_comment()} ></button>\r\n                </div>\r\n                <div className=\"comment_list\" ref = { el=>ref.current.comment_list = el}>\r\n                    {comment_list.length ===0?nList: cList }\r\n                </div>\r\n            </div>\r\n    )\r\n}\r\n\r\nconst Comment = props=>{\r\n    return (\r\n        <div className=\"comment\" id = {props.key}>\r\n            <UserImage user_id= {props.c_detials.uid} width={\"50px\"} height=\"50px\"\r\n             style= {{gridArea :\"user_image\" , borderWidth : \"2px\" , alignSelf : \"center\" , justifySelf: \"center\"}}\r\n             to = {`/Profile/${props.c_detials.uid}`} onClick={()=>null} />\r\n            <span id=\"user_name\">{props.c_detials.name}</span>\r\n            <p className=\"comment_text\" style={{whiteSpace:\"break-spaces\"}}>{props.c_detials.text}</p>\r\n            <div className=\"datetime\">{props.c_detials.upload_datetime}</div>\r\n        </div>\r\n    )\r\n}\r\nexport {Comment}"]},"metadata":{},"sourceType":"module"}