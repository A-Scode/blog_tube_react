{"ast":null,"code":"var _jsxFileName = \"D:\\\\Python files\\\\Start Django\\\\blog_tube\\\\frontend\\\\blog_tube\\\\src\\\\componenets\\\\appBlog.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport { useContext, useEffect, useState, useRef, useCallback } from \"react\";\nimport { useHistory, useParams } from \"react-router\";\nimport { Blog } from \"./appUploadBlog\";\nimport { BlogiansMiniProfile } from \"./appBlogians\";\nimport appConfig from './statics/appConfig.json';\nimport './statics/css/appUploadBlog.css';\nimport './statics/css/appBlog.css';\nimport view_logo from \"./statics/images/preview.svg\";\nimport like_logo from \"./statics/images/like.svg\";\nimport dislike_logo from \"./statics/images/dislike.svg\";\nimport { Login_context } from \"../App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AppBlog = props => {\n  _s();\n\n  const url = new URLSearchParams(window.location.search);\n  const blog_id = url.get('id');\n  const history = useHistory();\n\n  if (blog_id === null) {\n    history.push('/Error');\n  }\n\n  const [blog_data_list, set_blog_data_list] = useState([]);\n  const [blog_details, set_blog_details] = useState({\n    likes: \"\",\n    dislikes: \"\",\n    views: \"\",\n    title: \"\",\n    image_url: \"\",\n    blogger_details: \"\"\n  });\n  useEffect(() => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', appConfig.origin + 'backend_api/getBlog?blog_id=' + blog_id);\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        let response = JSON.parse(xhr.response);\n\n        switch (response.status) {\n          case \"success\":\n            set_blog_data_list(response.blog);\n            set_blog_details({\n              likes: response.likes,\n              dislikes: response.dislikes,\n              views: response.views,\n              title: response.title,\n              image_url: response.image_url,\n              blogger_details: response.blogger_details\n            });\n            break;\n\n          case \"page_not_found\":\n            history.push('/Error');\n            break;\n\n          case \"fail\":\n            history.push('/Error');\n            break;\n\n          default:\n            break;\n        }\n      }\n    };\n\n    xhr.send();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"blog_page\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      align: \"center\",\n      children: blog_details.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: blog_details.image_url,\n      className: \"title_image\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(BlogiansMiniProfile, {\n      user_details: blog_details.blogger_details,\n      onClick: () => null,\n      to: `/Profile/${blog_details.blogger_details.user_id}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Blog, {\n      children: blog_data_list.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container_data\",\n        dangerouslySetInnerHTML: {\n          __html: item\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 40\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ReviewBlog, {\n      blog_id: blog_id,\n      likes: blog_details.likes,\n      dislikes: blog_details.dislikes,\n      views: blog_details.views\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Comments, {\n      blog_id: blog_id\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 12\n  }, this);\n};\n\n_s(AppBlog, \"OjgwsiwW7/wGwOd58AxcYsa+eAo=\", false, function () {\n  return [useHistory];\n});\n\n_c = AppBlog;\nexport default AppBlog;\n\nconst ReviewBlog = props => {\n  _s2();\n\n  const session_id = useContext(Login_context);\n  const history = useHistory();\n  const [reviewed, set_reviewed] = useState(\"not yet\");\n  const [reviews, set_reviews] = useState({\n    likes: props.likes,\n    dislikes: props.dislikes,\n    views: props.views\n  });\n  const ref = useRef({});\n  useEffect(() => {\n    set_reviews({\n      likes: props.likes,\n      dislikes: props.dislikes,\n      views: props.views\n    });\n  }, [props.likes, props.dislikes, props.views]);\n\n  const review = event => {\n    let opt = event.target.value;\n\n    if (session_id === sessionStorage.session) {\n      let xhr = new XMLHttpRequest();\n      let uid = JSON.parse(localStorage.login_data).user_id;\n      xhr.open('POST', appConfig.origin + `backend_api/Blogreview`);\n\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          let response = JSON.parse(xhr.response);\n\n          if (response.status === \"success\") {\n            set_reviews({ ...response.details\n            });\n          }\n        }\n      };\n\n      let formdata = new FormData();\n      formdata.append('uid', uid);\n      formdata.append('bid', props.blog_id);\n      formdata.append('review', opt);\n      xhr.send(formdata);\n    } else {\n      history.push('/Error');\n    }\n  };\n\n  useEffect(() => {\n    if (session_id === sessionStorage.session) {\n      let xhr = new XMLHttpRequest();\n      let uid = JSON.parse(localStorage.login_data).user_id;\n      xhr.open('GET', appConfig.origin + `backend_api/checkReviewr?bid=${props.blog_id}&uid=${uid}`);\n\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          let response = JSON.parse(xhr.response);\n\n          if (response.status === \"success\") {\n            set_reviewed(response.isreviewer);\n          }\n        }\n      };\n\n      xhr.send();\n    }\n  }, [session_id]);\n  useEffect(() => {\n    if (reviewed === \"like\") {\n      ref.current.like.click();\n    } else if (reviewed === \"dislike\") {\n      ref.current.dislike.click();\n    }\n  }, [reviewed]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"review\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"radio\",\n      name: \"review\",\n      ref: el => ref.current.like = el,\n      id: \"like\",\n      value: \"like\",\n      onInput: e => review(e),\n      hidden: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"like\",\n      id: \"like_label\",\n      style: {\n        backgroundImage: `url(${like_logo})`\n      },\n      children: reviews.likes ? reviews.likes : \"No Likes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      id: \"view_label\",\n      style: {\n        backgroundImage: `url(${view_logo})`\n      },\n      children: reviews.views ? reviews.views : \"No Views\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"radio\",\n      name: \"review\",\n      ref: el => ref.current.dislike = el,\n      id: \"dislike\",\n      value: \"dislike\",\n      onInput: e => review(e),\n      hidden: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"dislike\",\n      id: \"dislike_label\",\n      style: {\n        backgroundImage: `url(${dislike_logo})`\n      },\n      children: reviews.dislikes ? reviews.dislikes : \"No Dislikes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 126,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(ReviewBlog, \"e2O+neoT90r5NONUwVLkCtvRG1A=\", false, function () {\n  return [useHistory];\n});\n\n_c2 = ReviewBlog;\n\nconst Comments = props => {\n  _s3();\n\n  let session_id = useContext(Login_context);\n  const ref = useRef({});\n  const [login_status, set_login_status] = useState(false);\n  useEffect(() => {\n    if (session_id === sessionStorage.session) {\n      set_login_status(true);\n    } else {\n      set_login_status(false);\n    }\n  }, [session_id]);\n  const send_comment = useCallback(() => {\n    if (session_id === sessionStorage) {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", appConfig.origin + `backend_api/uploadComment`);\n\n      xhr.onreadystatechange = () => {\n        let response = JSON.parse(xhr.response); // list has to be updated here\n      };\n\n      const formdata = new FormData();\n      xhr.setRequestHeader(\"session\", session_id);\n      formdata.append(\"comment\", ref.current.comment_input.value);\n      formdata.append(\"user_id\", JSON.parse(localStorage.login_data).user_id);\n      formdata.append(\"blog_id\", props.blog_id);\n      xhr.send(formdata);\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"comments\",\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      align: \"center\",\n      children: \"Comments\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cover\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"comment\",\n        id: \"comment_input\",\n        disabled: !login_status,\n        ref: el => ref.current.comment_input = el,\n        cols: \"3\",\n        rows: \"5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        ref: el => ref.current.send_comment = el,\n        id: \"send_comment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment_list\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 12\n  }, this);\n};\n\n_s3(Comments, \"7Tfbx5xrj4AcqTxuhcm+6TmoyBc=\");\n\n_c3 = Comments;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"AppBlog\");\n$RefreshReg$(_c2, \"ReviewBlog\");\n$RefreshReg$(_c3, \"Comments\");","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/src/componenets/appBlog.js"],"names":["useContext","useEffect","useState","useRef","useCallback","useHistory","useParams","Blog","BlogiansMiniProfile","appConfig","Login_context","AppBlog","props","url","URLSearchParams","window","location","search","blog_id","get","history","push","blog_data_list","set_blog_data_list","blog_details","set_blog_details","likes","dislikes","views","title","image_url","blogger_details","xhr","XMLHttpRequest","open","origin","onreadystatechange","readyState","status","response","JSON","parse","blog","send","user_id","map","item","__html","ReviewBlog","session_id","reviewed","set_reviewed","reviews","set_reviews","ref","review","event","opt","target","value","sessionStorage","session","uid","localStorage","login_data","details","formdata","FormData","append","isreviewer","current","like","click","dislike","el","e","backgroundImage","like_logo","view_logo","dislike_logo","Comments","login_status","set_login_status","send_comment","setRequestHeader","comment_input"],"mappings":";;;;;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,EAA0CC,MAA1C,EAAkDC,WAAlD,QAAoE,OAApE;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,cAAtC;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,SAASC,mBAAT,QAAoC,eAApC;AACA,OAAOC,SAAP,MAAsB,0BAAtB;AACA,OAAO,iCAAP;AACA,OAAO,2BAAP;;;;AAIA,SAASC,aAAT,QAA8B,QAA9B;;;AAEA,MAAMC,OAAO,GAAIC,KAAK,IAAE;AAAA;;AACpB,QAAMC,GAAG,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAZ;AACA,QAAMC,OAAO,GAAGL,GAAG,CAACM,GAAJ,CAAQ,IAAR,CAAhB;AACA,QAAMC,OAAO,GAAGf,UAAU,EAA1B;;AACA,MAAIa,OAAO,KAAK,IAAhB,EAAqB;AACjBE,IAAAA,OAAO,CAACC,IAAR,CAAa,QAAb;AACH;;AAED,QAAM,CAACC,cAAD,EAAkBC,kBAAlB,IAAwCrB,QAAQ,CAAC,EAAD,CAAtD;AACA,QAAM,CAACsB,YAAD,EAAgBC,gBAAhB,IAAoCvB,QAAQ,CAAC;AAACwB,IAAAA,KAAK,EAAC,EAAP;AAAYC,IAAAA,QAAQ,EAAC,EAArB;AAClDC,IAAAA,KAAK,EAAE,EAD2C;AACtCC,IAAAA,KAAK,EAAC,EADgC;AAC3BC,IAAAA,SAAS,EAAC,EADiB;AACdC,IAAAA,eAAe,EAAC;AADF,GAAD,CAAlD;AAGA9B,EAAAA,SAAS,CAAC,MAAI;AACd,UAAM+B,GAAG,GAAG,IAAIC,cAAJ,EAAZ;AACAD,IAAAA,GAAG,CAACE,IAAJ,CAAS,KAAT,EAAgBzB,SAAS,CAAC0B,MAAV,GAAiB,8BAAjB,GAAgDjB,OAAhE;;AACAc,IAAAA,GAAG,CAACI,kBAAJ,GAAwB,MAAI;AACxB,UAAIJ,GAAG,CAACK,UAAJ,KAAmB,CAAnB,IAAwBL,GAAG,CAACM,MAAJ,KAAe,GAA3C,EAA+C;AAC3C,YAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWT,GAAG,CAACO,QAAf,CAAf;;AACA,gBAAQA,QAAQ,CAACD,MAAjB;AACI,eAAK,SAAL;AACIf,YAAAA,kBAAkB,CAACgB,QAAQ,CAACG,IAAV,CAAlB;AACAjB,YAAAA,gBAAgB,CAAC;AAACC,cAAAA,KAAK,EAACa,QAAQ,CAACb,KAAhB;AACCC,cAAAA,QAAQ,EAACY,QAAQ,CAACZ,QADnB;AAEDC,cAAAA,KAAK,EAACW,QAAQ,CAACX,KAFd;AAGLC,cAAAA,KAAK,EAAEU,QAAQ,CAACV,KAHX;AAITC,cAAAA,SAAS,EAACS,QAAQ,CAACT,SAJV;AAKLC,cAAAA,eAAe,EAAGQ,QAAQ,CAACR;AALtB,aAAD,CAAhB;AAMA;;AACJ,eAAK,gBAAL;AACIX,YAAAA,OAAO,CAACC,IAAR,CAAa,QAAb;AACA;;AACJ,eAAK,MAAL;AACID,YAAAA,OAAO,CAACC,IAAR,CAAa,QAAb;AACA;;AACJ;AACI;AAjBR;AAmBH;AACJ,KAvBD;;AAwBAW,IAAAA,GAAG,CAACW,IAAJ;AACC,GA5BQ,EA4BP,EA5BO,CAAT;AA+BA,sBAAO;AAAK,IAAA,SAAS,EAAG,WAAjB;AAAA,4BACH;AAAI,MAAA,KAAK,EAAG,QAAZ;AAAA,gBAAsBnB,YAAY,CAACK;AAAnC;AAAA;AAAA;AAAA;AAAA,YADG,eAEH;AAAK,MAAA,GAAG,EAAIL,YAAY,CAACM,SAAzB;AAAoC,MAAA,SAAS,EAAG;AAAhD;AAAA;AAAA;AAAA;AAAA,YAFG,eAGH,QAAC,mBAAD;AAAqB,MAAA,YAAY,EAAIN,YAAY,CAACO,eAAlD;AAAmE,MAAA,OAAO,EAAE,MAAI,IAAhF;AAAuF,MAAA,EAAE,EAAI,YAAWP,YAAY,CAACO,eAAb,CAA6Ba,OAAQ;AAA7I;AAAA;AAAA;AAAA;AAAA,YAHG,eAIH,QAAC,IAAD;AAAA,gBACKtB,cAAc,CAACuB,GAAf,CAAmBC,IAAI,iBAAG;AAAK,QAAA,SAAS,EAAG,gBAAjB;AAAkC,QAAA,uBAAuB,EAAI;AAACC,UAAAA,MAAM,EAACD;AAAR;AAA7D;AAAA;AAAA;AAAA;AAAA,cAA1B;AADL;AAAA;AAAA;AAAA;AAAA,YAJG,eAOH,QAAC,UAAD;AAAY,MAAA,OAAO,EAAI5B,OAAvB;AAAgC,MAAA,KAAK,EAAIM,YAAY,CAACE,KAAtD;AAA6D,MAAA,QAAQ,EAAGF,YAAY,CAACG,QAArF;AAA+F,MAAA,KAAK,EAAGH,YAAY,CAACI;AAApH;AAAA;AAAA;AAAA;AAAA,YAPG,eAQH,QAAC,QAAD;AAAW,MAAA,OAAO,EAAIV;AAAtB;AAAA;AAAA;AAAA;AAAA,YARG;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AAUH,CArDD;;GAAMP,O;UAGcN,U;;;KAHdM,O;AAuDN,eAAeA,OAAf;;AAEA,MAAMqC,UAAU,GAACpC,KAAK,IAAE;AAAA;;AACpB,QAAMqC,UAAU,GAAGjD,UAAU,CAACU,aAAD,CAA7B;AACA,QAAMU,OAAO,GAAGf,UAAU,EAA1B;AACA,QAAK,CAAE6C,QAAF,EAAaC,YAAb,IAA6BjD,QAAQ,CAAC,SAAD,CAA1C;AACA,QAAK,CAACkD,OAAD,EAAUC,WAAV,IAAwBnD,QAAQ,CAAC;AAACwB,IAAAA,KAAK,EAAGd,KAAK,CAACc,KAAf;AAAsBC,IAAAA,QAAQ,EAAGf,KAAK,CAACe,QAAvC;AAAiDC,IAAAA,KAAK,EAAGhB,KAAK,CAACgB;AAA/D,GAAD,CAArC;AACA,QAAM0B,GAAG,GAAGnD,MAAM,CAAC,EAAD,CAAlB;AACAF,EAAAA,SAAS,CAAC,MAAI;AACVoD,IAAAA,WAAW,CAAC;AAAC3B,MAAAA,KAAK,EAAGd,KAAK,CAACc,KAAf;AAAsBC,MAAAA,QAAQ,EAAGf,KAAK,CAACe,QAAvC;AAAiDC,MAAAA,KAAK,EAAGhB,KAAK,CAACgB;AAA/D,KAAD,CAAX;AACH,GAFQ,EAEP,CAAChB,KAAK,CAACc,KAAP,EAAed,KAAK,CAACe,QAArB,EAAgCf,KAAK,CAACgB,KAAtC,CAFO,CAAT;;AAIA,QAAM2B,MAAM,GAACC,KAAK,IAAE;AAChB,QAAIC,GAAG,GAAGD,KAAK,CAACE,MAAN,CAAaC,KAAvB;;AACA,QAAIV,UAAU,KAAKW,cAAc,CAACC,OAAlC,EAA2C;AACvC,UAAI7B,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACA,UAAI6B,GAAG,GAAGtB,IAAI,CAACC,KAAL,CAAWsB,YAAY,CAACC,UAAxB,EAAoCpB,OAA9C;AACAZ,MAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAkBzB,SAAS,CAAC0B,MAAV,GAAkB,wBAApC;;AACAH,MAAAA,GAAG,CAACI,kBAAJ,GAAuB,MAAI;AAAC,YAAGJ,GAAG,CAACK,UAAJ,KAAiB,CAAjB,IAAsBL,GAAG,CAACM,MAAJ,KAAa,GAAtC,EAA0C;AAClE,cAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWT,GAAG,CAACO,QAAf,CAAf;;AACA,cAAGA,QAAQ,CAACD,MAAT,KAAkB,SAArB,EAA+B;AAC3Be,YAAAA,WAAW,CAAC,EAAC,GAAGd,QAAQ,CAAC0B;AAAb,aAAD,CAAX;AACH;AACJ;AAAC,OALF;;AAMA,UAAIC,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,KAAhB,EAAwBN,GAAxB;AACAI,MAAAA,QAAQ,CAACE,MAAT,CAAgB,KAAhB,EAAwBxD,KAAK,CAACM,OAA9B;AACAgD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,QAAhB,EAA2BX,GAA3B;AACAzB,MAAAA,GAAG,CAACW,IAAJ,CAASuB,QAAT;AACH,KAfD,MAeK;AACD9C,MAAAA,OAAO,CAACC,IAAR,CAAa,QAAb;AACH;AACJ,GApBD;;AAqBApB,EAAAA,SAAS,CAAC,MAAI;AACV,QAAIgD,UAAU,KAAGW,cAAc,CAACC,OAAhC,EAAwC;AAEpC,UAAI7B,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACA,UAAI6B,GAAG,GAAGtB,IAAI,CAACC,KAAL,CAAWsB,YAAY,CAACC,UAAxB,EAAoCpB,OAA9C;AACAZ,MAAAA,GAAG,CAACE,IAAJ,CAAS,KAAT,EAAiBzB,SAAS,CAAC0B,MAAV,GAAkB,gCAA+BvB,KAAK,CAACM,OAAQ,QAAO4C,GAAI,EAA3F;;AACA9B,MAAAA,GAAG,CAACI,kBAAJ,GAAuB,MAAI;AAAC,YAAGJ,GAAG,CAACK,UAAJ,KAAiB,CAAjB,IAAsBL,GAAG,CAACM,MAAJ,KAAa,GAAtC,EAA0C;AAClE,cAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWT,GAAG,CAACO,QAAf,CAAf;;AACA,cAAGA,QAAQ,CAACD,MAAT,KAAkB,SAArB,EAA+B;AAC3Ba,YAAAA,YAAY,CAAEZ,QAAQ,CAAC8B,UAAX,CAAZ;AACH;AACJ;AAAC,OALF;;AAMArC,MAAAA,GAAG,CAACW,IAAJ;AACH;AACJ,GAdQ,EAcP,CAACM,UAAD,CAdO,CAAT;AAeAhD,EAAAA,SAAS,CAAC,MAAI;AACV,QAAIiD,QAAQ,KAAK,MAAjB,EAAwB;AACpBI,MAAAA,GAAG,CAACgB,OAAJ,CAAYC,IAAZ,CAAiBC,KAAjB;AACH,KAFD,MAEM,IAAItB,QAAQ,KAAK,SAAjB,EAA2B;AAC7BI,MAAAA,GAAG,CAACgB,OAAJ,CAAYG,OAAZ,CAAoBD,KAApB;AACH;AACJ,GANQ,EAMP,CAACtB,QAAD,CANO,CAAT;AASA,sBACI;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA,4BACI;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,IAAI,EAAC,QAAzB;AAAkC,MAAA,GAAG,EAAIwB,EAAE,IAAEpB,GAAG,CAACgB,OAAJ,CAAYC,IAAZ,GAAmBG,EAAhE;AAAqE,MAAA,EAAE,EAAC,MAAxE;AAA+E,MAAA,KAAK,EAAG,MAAvF;AAA+F,MAAA,OAAO,EAAEC,CAAC,IAAEpB,MAAM,CAACoB,CAAD,CAAjH;AAAuH,MAAA,MAAM;AAA7H;AAAA;AAAA;AAAA;AAAA,YADJ,eAEI;AAAO,MAAA,OAAO,EAAC,MAAf;AAAsB,MAAA,EAAE,EAAC,YAAzB;AAAsC,MAAA,KAAK,EAAE;AAACC,QAAAA,eAAe,EAAE,OAAMC,SAAU;AAAlC,OAA7C;AAAA,gBAAsFzB,OAAO,CAAC1B,KAAR,GAAc0B,OAAO,CAAC1B,KAAtB,GAA4B;AAAlH;AAAA;AAAA;AAAA;AAAA,YAFJ,eAGI;AAAO,MAAA,EAAE,EAAE,YAAX;AAAwB,MAAA,KAAK,EAAE;AAACkD,QAAAA,eAAe,EAAE,OAAME,SAAU;AAAlC,OAA/B;AAAA,gBAAuE1B,OAAO,CAACxB,KAAR,GAAcwB,OAAO,CAACxB,KAAtB,GAA4B;AAAnG;AAAA;AAAA;AAAA;AAAA,YAHJ,eAII;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,IAAI,EAAC,QAAzB;AAAkC,MAAA,GAAG,EAAI8C,EAAE,IAAEpB,GAAG,CAACgB,OAAJ,CAAYG,OAAZ,GAAsBC,EAAnE;AAAwE,MAAA,EAAE,EAAC,SAA3E;AAAqF,MAAA,KAAK,EAAE,SAA5F;AAAuG,MAAA,OAAO,EAAEC,CAAC,IAAEpB,MAAM,CAACoB,CAAD,CAAzH;AAA8H,MAAA,MAAM;AAApI;AAAA;AAAA;AAAA;AAAA,YAJJ,eAKI;AAAO,MAAA,OAAO,EAAC,SAAf;AAAyB,MAAA,EAAE,EAAC,eAA5B;AAA4C,MAAA,KAAK,EAAE;AAACC,QAAAA,eAAe,EAAE,OAAMG,YAAa;AAArC,OAAnD;AAAA,gBAAgG3B,OAAO,CAACzB,QAAR,GAAiByB,OAAO,CAACzB,QAAzB,GAAkC;AAAlI;AAAA;AAAA;AAAA;AAAA,YALJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AASH,CAhED;;IAAMqB,U;UAEc3C,U;;;MAFd2C,U;;AAkEN,MAAMgC,QAAQ,GAAEpE,KAAK,IAAE;AAAA;;AACnB,MAAIqC,UAAU,GAAGjD,UAAU,CAACU,aAAD,CAA3B;AACA,QAAM4C,GAAG,GAAGnD,MAAM,CAAC,EAAD,CAAlB;AACA,QAAM,CAAC8E,YAAD,EAAgBC,gBAAhB,IAAoChF,QAAQ,CAAC,KAAD,CAAlD;AACAD,EAAAA,SAAS,CAAC,MAAI;AACV,QAAGgD,UAAU,KAAKW,cAAc,CAACC,OAAjC,EAAyC;AACrCqB,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACH,KAFD,MAEK;AACDA,MAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACH;AACJ,GANQ,EAMP,CAACjC,UAAD,CANO,CAAT;AAQA,QAAMkC,YAAY,GAAG/E,WAAW,CAAC,MAAI;AACjC,QAAI6C,UAAU,KAAKW,cAAnB,EAAkC;AAC9B,YAAM5B,GAAG,GAAG,IAAIC,cAAJ,EAAZ;AACAD,MAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAkBzB,SAAS,CAAC0B,MAAV,GAAkB,2BAApC;;AACAH,MAAAA,GAAG,CAACI,kBAAJ,GAAyB,MAAI;AACzB,YAAIG,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWT,GAAG,CAACO,QAAf,CAAf,CADyB,CACgB;AAC5C,OAFD;;AAGA,YAAM2B,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAnC,MAAAA,GAAG,CAACoD,gBAAJ,CAAqB,SAArB,EAAgCnC,UAAhC;AACAiB,MAAAA,QAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA4Bd,GAAG,CAACgB,OAAJ,CAAYe,aAAZ,CAA0B1B,KAAtD;AACAO,MAAAA,QAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA6B5B,IAAI,CAACC,KAAL,CAAWsB,YAAY,CAACC,UAAxB,EAAoCpB,OAAjE;AACAsB,MAAAA,QAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA4BxD,KAAK,CAACM,OAAlC;AACAc,MAAAA,GAAG,CAACW,IAAJ,CAASuB,QAAT;AACH;AACJ,GAd+B,CAAhC;AAeA,sBAAO;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA,4BACK;AAAI,MAAA,KAAK,EAAG,QAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADL,eAEK;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA,8BACA;AAAU,QAAA,IAAI,EAAC,SAAf;AAAyB,QAAA,EAAE,EAAC,eAA5B;AAA6C,QAAA,QAAQ,EAAE,CAACe,YAAxD;AACA,QAAA,GAAG,EAAEP,EAAE,IAAEpB,GAAG,CAACgB,OAAJ,CAAYe,aAAZ,GAA4BX,EADrC;AACyC,QAAA,IAAI,EAAC,GAD9C;AACkD,QAAA,IAAI,EAAC;AADvD;AAAA;AAAA;AAAA;AAAA,cADA,eAIA;AAAQ,QAAA,GAAG,EAAIA,EAAE,IAAEpB,GAAG,CAACgB,OAAJ,CAAYa,YAAZ,GAA2BT,EAA9C;AACG,QAAA,EAAE,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,cAJA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFL,eASK;AAAK,MAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,YATL;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AAcH,CAzCD;;IAAMM,Q;;MAAAA,Q","sourcesContent":["import { useContext, useEffect, useState ,useRef, useCallback} from \"react\";\r\nimport { useHistory, useParams } from \"react-router\";\r\nimport { Blog } from \"./appUploadBlog\";\r\nimport { BlogiansMiniProfile } from \"./appBlogians\";\r\nimport appConfig from './statics/appConfig.json'\r\nimport './statics/css/appUploadBlog.css'\r\nimport './statics/css/appBlog.css'\r\nimport view_logo from './statics/images/preview.svg'\r\nimport like_logo from './statics/images/like.svg'\r\nimport dislike_logo from './statics/images/dislike.svg'\r\nimport { Login_context } from \"../App\";\r\n\r\nconst AppBlog  = props=>{\r\n    const url = new URLSearchParams(window.location.search)\r\n    const blog_id = url.get('id')    \r\n    const history = useHistory()\r\n    if (blog_id === null){\r\n        history.push('/Error')\r\n    }\r\n\r\n    const [blog_data_list , set_blog_data_list] = useState([])\r\n    const [blog_details , set_blog_details] = useState({likes:\"\" , dislikes:\"\" ,\r\n     views :\"\" , title:\"\" , image_url:\"\",blogger_details:\"\"})\r\n\r\n    useEffect(()=>{\r\n    const xhr = new XMLHttpRequest()\r\n    xhr.open('GET' ,appConfig.origin+'backend_api/getBlog?blog_id='+blog_id )\r\n    xhr.onreadystatechange =()=>{\r\n        if (xhr.readyState === 4 && xhr.status === 200){\r\n            let response = JSON.parse(xhr.response)\r\n            switch (response.status){\r\n                case \"success\":\r\n                    set_blog_data_list(response.blog)\r\n                    set_blog_details({likes:response.likes ,\r\n                                      dislikes:response.dislikes ,\r\n                                    views:response.views ,\r\n                                title :response.title ,\r\n                            image_url:response.image_url,\r\n                                blogger_details : response.blogger_details})\r\n                    break;\r\n                case \"page_not_found\":\r\n                    history.push('/Error')\r\n                    break;\r\n                case \"fail\":\r\n                    history.push('/Error')\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    xhr.send()\r\n    },[])\r\n\r\n\r\n    return(<div className = \"blog_page\">\r\n        <h2 align = \"center\">{blog_details.title}</h2>\r\n        <img src = {blog_details.image_url} className = \"title_image\" />\r\n        <BlogiansMiniProfile user_details = {blog_details.blogger_details} onClick={()=>null}  to ={`/Profile/${blog_details.blogger_details.user_id}`} />\r\n        <Blog>\r\n            {blog_data_list.map(item=>(<div className = \"container_data\" dangerouslySetInnerHTML = {{__html:item}}></div>))}\r\n        </Blog>\r\n        <ReviewBlog blog_id = {blog_id} likes = {blog_details.likes} dislikes= {blog_details.dislikes} views= {blog_details.views} />\r\n        <Comments  blog_id = {blog_id} />\r\n    </div>)\r\n}\r\n\r\nexport default AppBlog\r\n\r\nconst ReviewBlog=props=>{\r\n    const session_id = useContext(Login_context)\r\n    const history = useHistory()\r\n    const[ reviewed  ,set_reviewed] = useState(\"not yet\")\r\n    const[reviews ,set_reviews] =useState({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    const ref = useRef({})\r\n    useEffect(()=>{\r\n        set_reviews({likes : props.likes ,dislikes : props.dislikes ,views : props.views})\r\n    },[props.likes , props.dislikes , props.views])\r\n\r\n    const review=event=>{\r\n        let opt = event.target.value\r\n        if (session_id === sessionStorage.session ){\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(localStorage.login_data).user_id\r\n            xhr.open('POST' , appConfig.origin+`backend_api/Blogreview`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviews({...response.details})\r\n                }\r\n            }}\r\n            let formdata = new FormData()\r\n            formdata.append('uid' , uid)\r\n            formdata.append('bid' , props.blog_id)\r\n            formdata.append('review' , opt)\r\n            xhr.send(formdata)\r\n        }else{\r\n            history.push('/Error')\r\n        }\r\n    }\r\n    useEffect(()=>{\r\n        if (session_id===sessionStorage.session){\r\n\r\n            let xhr = new XMLHttpRequest()\r\n            let uid = JSON.parse(localStorage.login_data).user_id\r\n            xhr.open('GET' , appConfig.origin+`backend_api/checkReviewr?bid=${props.blog_id}&uid=${uid}`)\r\n            xhr.onreadystatechange=()=>{if(xhr.readyState===4 && xhr.status===200){\r\n                let response = JSON.parse(xhr.response)\r\n                if(response.status===\"success\"){\r\n                    set_reviewed( response.isreviewer)\r\n                }\r\n            }}\r\n            xhr.send()\r\n        }\r\n    },[session_id])\r\n    useEffect(()=>{\r\n        if (reviewed === \"like\"){\r\n            ref.current.like.click()\r\n        }else if (reviewed === \"dislike\"){\r\n            ref.current.dislike.click()\r\n        }\r\n    },[reviewed])\r\n\r\n    \r\n    return(\r\n        <div className=\"review\">\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.like = el}  id=\"like\" value= {\"like\"} onInput={e=>review(e)}  hidden/>\r\n            <label htmlFor=\"like\" id=\"like_label\" style={{backgroundImage:`url(${like_logo})`}} >{reviews.likes?reviews.likes:\"No Likes\"}</label>\r\n            <label id =\"view_label\" style={{backgroundImage:`url(${view_logo})`}}>{reviews.views?reviews.views:\"No Views\"}</label>\r\n            <input type=\"radio\" name=\"review\" ref = {el=>ref.current.dislike = el}  id=\"dislike\" value={\"dislike\"} onInput={e=>review(e)} hidden/>\r\n            <label htmlFor=\"dislike\" id=\"dislike_label\" style={{backgroundImage:`url(${dislike_logo})`}}  >{reviews.dislikes?reviews.dislikes:\"No Dislikes\"}</label>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Comments =props=>{\r\n    let session_id = useContext(Login_context)\r\n    const ref = useRef({})\r\n    const [login_status , set_login_status] = useState(false)\r\n    useEffect(()=>{\r\n        if(session_id === sessionStorage.session){\r\n            set_login_status(true)\r\n        }else{\r\n            set_login_status(false)\r\n        }\r\n    },[session_id])\r\n\r\n    const send_comment = useCallback(()=>{\r\n        if (session_id === sessionStorage){\r\n            const xhr = new XMLHttpRequest()\r\n            xhr.open(\"POST\" , appConfig.origin+`backend_api/uploadComment`)\r\n            xhr.onreadystatechange = ()=>{\r\n                let response = JSON.parse(xhr.response)  // list has to be updated here\r\n            }\r\n            const formdata = new FormData()\r\n            xhr.setRequestHeader(\"session\" ,session_id )\r\n            formdata.append(\"comment\" , ref.current.comment_input.value)\r\n            formdata.append(\"user_id\"  , JSON.parse(localStorage.login_data).user_id)\r\n            formdata.append(\"blog_id\" , props.blog_id)\r\n            xhr.send(formdata)\r\n        }\r\n    })\r\n    return(<div className=\"comments\">\r\n                <h5 align = \"center\">Comments</h5>\r\n                <div className=\"cover\">\r\n                <textarea name=\"comment\" id=\"comment_input\"  disabled={!login_status}\r\n                ref={el=>ref.current.comment_input = el} cols=\"3\" rows=\"5\">\r\n                </textarea>\r\n                <button ref = {el=>ref.current.send_comment = el} \r\n                   id=\"send_comment\"></button>\r\n                </div>\r\n                <div className=\"comment_list\">\r\n\r\n                </div>\r\n            </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}