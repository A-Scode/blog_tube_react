{"ast":null,"code":"import _slicedToArray from\"D:/Python files/Start Django/blog_tube/frontend/blog_tube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./statics/css/appLogin.css';import email_logo from\"./statics/images/email.svg\";import password_logo from\"./statics/images/password.svg\";import form_background from\"./statics/images/form_background.svg\";import appConfig from'./statics/appConfig.json';import anime from'animejs';import{Login_context,Theme_context}from'../App';import{useEffect,useRef,useState,useCallback,useMemo,useContext}from'react';import{Link,useHistory}from'react-router-dom';import{logout}from'./statics/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AppLogin=function AppLogin(props){var _ref=useRef({});var _useState=useState('form'),_useState2=_slicedToArray(_useState,2),Error=_useState2[0],set_Error=_useState2[1];var history=useHistory();useEffect(function(){try{anime({targets:_ref.current['heading'],update:function update(anime){try{_ref.current['heading'].style.filter=\"hue-rotate(\".concat(anime.progress*3.6,\"deg)\");}catch(err){}},duration:2000,autoplay:true,direction:'alternate',loop:true});if(Error){_ref.current['form'].style.backgroundImage=\"url(\".concat(form_background,\")\");if(_ref.current['email'])_ref.current['email'].style.backgroundImage=\"url(\".concat(email_logo,\")\");if(_ref.current['confirm_password'])_ref.current['confirm_password'].style.backgroundImage=\"url(\".concat(password_logo,\")\");_ref.current['password'].style.backgroundImage=\"url(\".concat(password_logo,\")\");}}catch(err){console.log(err);}},[_ref,Error]);var origin=appConfig.origin;var Login=useCallback(function(event){event.preventDefault();var form=event.target;var email_input=form[0];var password_input=form[1];var xhr=new XMLHttpRequest();xhr.open('POST',\"\".concat(origin,\"backend_api/loginmanully\"));props.appbodyloading('flex');xhr.onreadystatechange=function(){if(xhr.status===200&&xhr.readyState===4){var response=JSON.parse(xhr.response);if(response.status===\"fail\"){set_Error(\"error\");props.appbodyloading('none');}else if(response.status===\"not_match\"){password_input.focus();password_input.setCustomValidity('⚠️invalid password⚠️Forgot password ?');password_input.reportValidity();setTimeout(function(){return password_input.setCustomValidity('');},2000);props.appbodyloading('none');}else if(response.status===\"success\"){logout();props.change_login_context(response.session);sessionStorage.setItem('session',response.session);var login_data=JSON.stringify(response.login_data);localStorage['login_data']=login_data;sessionStorage['login_data']=login_data;history.push('/Home');props.appbodyloading('none');}}};xhr.setRequestHeader(\"credentails\",JSON.stringify({email:email_input.value,password:password_input.value}));xhr.send();});var theme_context=useContext(Theme_context);useEffect(function(){if(theme_context===\"Dark\"){_ref.current['email']?_ref.current['email'].style.color='white':console.log();_ref.current['password']?_ref.current['password'].style.color='white':console.log();_ref.current['confirm_password']?_ref.current['confirm_password'].style.color='white':console.log();}else{_ref.current['email']?_ref.current['email'].style.color='none':console.log();_ref.current['password']?_ref.current['password'].style.color='none':console.log();_ref.current['confirm_password']?_ref.current['confirm_password'].style.color='none':console.log();}},[theme_context,_ref,Error]);var login_form=useMemo(function(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",ref:function ref(el){return _ref.current['heading']=el;},children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"javascript:void(0);\",method:\"POST\",onSubmit:function onSubmit(e){return Login(e);},children:[/*#__PURE__*/_jsx(\"input\",{id:\"email\",maxLength:100,type:\"email\",ref:function ref(el){return _ref.current['email']=el;},placeholder:\"Email\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",minLength:8,maxLength:100,id:\"password\",ref:function ref(el){return _ref.current['password']=el;},placeholder:\"Password\",required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"submit\",type:\"submit\",value:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"redirectSignup\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Didn't Have an account?\",/*#__PURE__*/_jsx(Link,{to:\"/Signup\",children:\"SignUp\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"a\",{href:\"javascript:void(0);\",onClick:function onClick(){return set_Error('ask_email');},children:\"Forgot Password \"})]})})]})]});});var error_msg=useMemo(function(){return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[/*#__PURE__*/_jsx(\"h2\",{ref:function ref(el){return _ref.current['heading']=el;},align:\"cetner\",children:\"Invalid Credentials\"}),/*#__PURE__*/_jsx(\"button\",{className:\"back\",onClick:function onClick(){return set_Error(\"form\");},children:\"Back\"})]});});//email_form functions\nvar forgot_pass_email=useCallback(function(event){var form=event.target;var email_input=form[0];var email=email_input.value;var xhr=new XMLHttpRequest();xhr.open('POST',origin+\"backend_api/forgototp\");props.appbodyloading('flex');xhr.onreadystatechange=function(){if(xhr.status===200&&xhr.readyState===4){var response=JSON.parse(xhr.response);console.log(response);if(response.status===\"error\"){set_Error('error');props.appbodyloading('none');}else if(response.status==='success'){set_Error('otp');props.appbodyloading('none');}}};xhr.setRequestHeader(\"userData\",JSON.stringify({email:email}));xhr.send();});var email_form=useMemo(function(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",ref:function ref(el){return _ref.current['heading']=el;},children:\"Email\"}),/*#__PURE__*/_jsx(\"div\",{className:\"forgot_form\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"javascript:void(0);\",onSubmit:forgot_pass_email,children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",ref:function ref(el){return _ref.current['email']=el;},placeholder:\"Email\",required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"submit\",type:\"submit\",value:\"Submit\"})]})})]});});var forgot_pass_otp=useCallback(function(event){var form=event.target;var otp_input=form[0];var xhr=new XMLHttpRequest();xhr.open('POST',origin+'backend_api/validateforgototp');props.appbodyloading('flex');xhr.onreadystatechange=function(){if(xhr.status===200&&xhr.readyState===4){var response=JSON.parse(xhr.response);console.log(response);if(response.status==='fail'){otp_input.focus();otp_input.setCustomValidity('⚠️invalid OTP⚠️');otp_input.reportValidity();props.appbodyloading('none');}else if(response.status==='success'){set_Error('change_password');props.appbodyloading('none');}}};xhr.setRequestHeader('otp',otp_input.value);xhr.send();});var validotp=useCallback(function(e){if(e.target.value.length>4){e.target.setCustomValidity('OTP must be of 4 digit');e.target.reportValidity();}else if(e.target.value.length<4){e.target.setCustomValidity('OTP must have 4 digits');}else{e.target.setCustomValidity('');}});var otp_form=useMemo(function(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",ref:function ref(el){return _ref.current['heading']=el;},children:\"OTP\"}),/*#__PURE__*/_jsx(\"div\",{className:\"forgot_form\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"javascript:void(0);\",onSubmit:forgot_pass_otp,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",onInput:validotp,id:\"password\",ref:function ref(el){return _ref.current['password']=el;},placeholder:\"OTP\",required:true,style:{fontSize:'35px',letterSpacing:\"20px\",paddingLeft:\"60px\"}}),/*#__PURE__*/_jsx(\"input\",{className:\"submit\",type:\"submit\",value:\"Submit\"})]})})]});});var change_pass=useCallback(function(event){var form=event.target;var password_input=form[1];var xhr=new XMLHttpRequest();xhr.open('POST',origin+'backend_api/changepassword');props.appbodyloading('flex');xhr.onreadystatechange=function(){if(xhr.status===200&&xhr.readyState===4){var response=JSON.parse(xhr.response);if(response.status==='fail'){password_input.focus();password_input.setCustomValidity('Something went wrong');password_input.reportValidity();props.appbodyloading('none');}else if(response.status==='success'){set_Error('form');props.appbodyloading('none');}}};xhr.setRequestHeader('newpass',password_input.value);xhr.send();});var change_pass_from=useMemo(function(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",ref:function ref(el){return _ref.current['heading']=el;},children:\"Change\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"javascript:void(0);\",onSubmit:change_pass,children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",minLength:8,maxLength:100,id:\"password\",ref:function ref(el){return _ref.current['password']=el;},placeholder:\"New password\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",minLength:8,maxLength:100,id:\"password\",onInput:function onInput(e){return e.target.setCustomValidity('');},ref:function ref(el){return _ref.current['confirm_password']=el;},placeholder:\"Confirm password\",required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"submit\",type:\"submit\",value:\"Change\"})]})]});});return/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form\",ref:function ref(el){return _ref.current['form']=el;},children:[Error===\"form\"?login_form:null,Error===\"ask_email\"?email_form:null,Error===\"otp\"?otp_form:null,Error===\"change_password\"?change_pass_from:null,Error===\"error\"?error_msg:null]})});};export default AppLogin;","map":{"version":3,"sources":["D:/Python files/Start Django/blog_tube/frontend/blog_tube/src/componenets/appLogin.js"],"names":["appConfig","anime","Login_context","Theme_context","useEffect","useRef","useState","useCallback","useMemo","useContext","Link","useHistory","logout","AppLogin","props","ref","Error","set_Error","history","targets","current","update","style","filter","progress","err","duration","autoplay","direction","loop","backgroundImage","form_background","email_logo","password_logo","console","log","origin","Login","event","preventDefault","form","target","email_input","password_input","xhr","XMLHttpRequest","open","appbodyloading","onreadystatechange","status","readyState","response","JSON","parse","focus","setCustomValidity","reportValidity","setTimeout","change_login_context","session","sessionStorage","setItem","login_data","stringify","localStorage","push","setRequestHeader","email","value","password","send","theme_context","color","login_form","el","e","error_msg","forgot_pass_email","email_form","forgot_pass_otp","otp_input","validotp","length","otp_form","fontSize","letterSpacing","paddingLeft","change_pass","change_pass_from"],"mappings":"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","sourcesContent":["import './statics/css/appLogin.css'\r\nimport email_logo from './statics/images/email.svg'\r\nimport password_logo from './statics/images/password.svg'\r\nimport form_background from './statics/images/form_background.svg'\r\nimport appConfig from './statics/appConfig.json'\r\n\r\nimport anime from 'animejs'\r\nimport { Login_context, Theme_context } from '../App'\r\nimport { useEffect, useRef , useState , useCallback, useMemo, useContext} from 'react'\r\nimport {\r\n    Link,useHistory} from 'react-router-dom'\r\nimport { logout } from './statics/utils'\r\n\r\nvar AppLogin = props=>{\r\n   \r\n    let ref = useRef({})\r\n    let [Error, set_Error] = useState('form')\r\n    const history = useHistory()\r\n\r\n\r\n    useEffect(()=>{\r\n        try{\r\n            anime({\r\n                targets:ref.current['heading'],\r\n                update:function(anime){\r\n                    try{\r\n                    ref.current['heading'].style.filter = `hue-rotate(${anime.progress *3.6}deg)`\r\n                    }catch(err){}\r\n                },\r\n                duration:2000,\r\n                autoplay:true,\r\n                direction:'alternate',\r\n                loop:true\r\n            })\r\n        if (Error){\r\n            ref.current['form'].style.backgroundImage = `url(${form_background})`\r\n            if(ref.current['email'])ref.current['email'].style.backgroundImage = `url(${email_logo})` \r\n            if(ref.current['confirm_password'])ref.current['confirm_password'].style.backgroundImage = `url(${password_logo})` \r\n        ref.current['password'].style.backgroundImage = `url(${password_logo})`\r\n    }\r\n    }catch(err){\r\n        console.log(err)\r\n    }\r\n\r\n\r\n    },[ref , Error])\r\n\r\n    const origin = appConfig.origin\r\n\r\n   let Login = useCallback((event)=>{\r\n       event.preventDefault()\r\n        let form = event.target\r\n        let email_input = form[0]\r\n        let password_input = form[1]\r\n\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST', `${origin}backend_api/loginmanully`)\r\n        props.appbodyloading('flex')\r\n\r\n        xhr.onreadystatechange = ()=>{\r\n            if (xhr.status === 200 && xhr.readyState === 4){\r\n                let response = JSON.parse(xhr.response)\r\n                \r\n                if(response.status === \"fail\"){\r\n                    set_Error(\"error\")\r\n                    props.appbodyloading('none')\r\n\r\n                }else if(response.status === \"not_match\"){\r\n                    password_input.focus()\r\n                    password_input.setCustomValidity('⚠️invalid password⚠️Forgot password ?')\r\n                    password_input.reportValidity()\r\n                    setTimeout(()=>password_input.setCustomValidity('') , 2000)\r\n                    props.appbodyloading('none')\r\n\r\n                }else if(response.status === \"success\"){\r\n                    logout()\r\n                    props.change_login_context(response.session)\r\n                    sessionStorage.setItem('session', response.session)\r\n                    let login_data = JSON.stringify(response.login_data)\r\n                    localStorage['login_data'] = login_data\r\n                    sessionStorage['login_data'] = login_data\r\n                    history.push('/Home')\r\n                    props.appbodyloading('none')\r\n                }\r\n            }\r\n        }\r\n\r\n        xhr.setRequestHeader(\"credentails\" , JSON.stringify({email : email_input.value,\r\n                                                        password : password_input.value}))\r\n        xhr.send()\r\n    })\r\n    \r\n    var theme_context = useContext(Theme_context)\r\n\r\n    useEffect(()=>{\r\n        if(theme_context=== \"Dark\"){\r\n            ref.current['email']?ref.current['email'].style.color='white':console.log()\r\n            ref.current['password']?ref.current['password'].style.color='white':console.log()\r\n            ref.current['confirm_password']?ref.current['confirm_password'].style.color='white':console.log()\r\n        }\r\n        else{\r\n            ref.current['email']?ref.current['email'].style.color='none':console.log()\r\n            ref.current['password']?ref.current['password'].style.color='none':console.log()\r\n            ref.current['confirm_password']?ref.current['confirm_password'].style.color='none':console.log()\r\n\r\n        }\r\n    },[theme_context,ref,Error])\r\n\r\n    let login_form =useMemo(()=> (<><h1 align='center' ref = {el =>ref.current['heading'] =el} >Login</h1>\r\n    <form action= 'javascript:void(0);' method = 'POST' onSubmit =  {(e)=>Login(e) } >  \r\n        <input id='email' maxLength={100} type=\"email\" ref= {el=>ref.current['email']= el} placeholder = 'Email' required = {true} />\r\n        <input type=\"password\" minLength={8} maxLength={100} id='password' ref = {el=>ref.current['password']=el}  placeholder= \"Password\" required = {true} />\r\n        <input className='submit' type=\"submit\"  value= 'Login'   />\r\n        <div className=\"redirectSignup\">\r\n                    <p>Didn't Have an account?<Link to = '/Signup'>SignUp</Link>\r\n                    <br />\r\n                    <a href = \"javascript:void(0);\" onClick = {()=>set_Error('ask_email')} >Forgot Password </a>\r\n                    </p>\r\n                </div>\r\n    </form></>))\r\n\r\n    let error_msg =useMemo(()=> (<div className = 'error'>\r\n    <h2 ref = {el =>ref.current['heading'] =el} align = 'cetner'>Invalid Credentials</h2>\r\n    <button className = \"back\"  onClick = {()=>set_Error(\"form\")} >Back</button>\r\n    \r\n    </div>))\r\n\r\n    //email_form functions\r\n    let forgot_pass_email= useCallback(event=>{\r\n        let form = event.target\r\n        let email_input = form[0]\r\n        let email = email_input.value\r\n\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST', origin + \"backend_api/forgototp\")\r\n        props.appbodyloading('flex')\r\n\r\n        xhr.onreadystatechange = ()=>{\r\n            if(xhr.status === 200 && xhr.readyState === 4){\r\n                let response = JSON.parse(xhr.response)\r\n                console.log(response)\r\n\r\n                if (response.status === \"error\"){\r\n                    set_Error('error')\r\n                    props.appbodyloading('none')\r\n                }else if (response.status === 'success'){\r\n                    set_Error('otp')\r\n                    props.appbodyloading('none')\r\n                }\r\n            }\r\n        }\r\n\r\n        xhr.setRequestHeader(\"userData\" , JSON.stringify({ email : email}))\r\n        xhr.send()\r\n    })\r\n\r\n    let email_form = useMemo(()=>(<>\r\n            <h1 align='center' ref = {el =>ref.current['heading'] =el} >Email</h1>\r\n        <div className = \"forgot_form\"  >\r\n            <form action=\"javascript:void(0);\" onSubmit = {forgot_pass_email} >\r\n            <input type=\"email\" id='email' ref={el => ref.current['email']=el} placeholder= \"Email\" required = {true} />\r\n            <input className='submit' type=\"submit\"  value= 'Submit'   />\r\n            </form>\r\n        </div>\r\n        </>\r\n    ))\r\n    \r\n    let forgot_pass_otp = useCallback( event =>{\r\n        let form = event.target\r\n        let otp_input  = form [0]\r\n\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST', origin+'backend_api/validateforgototp')\r\n        props.appbodyloading('flex')\r\n\r\n        xhr.onreadystatechange = ()=>{\r\n            if (xhr.status === 200 && xhr.readyState === 4){\r\n                let response = JSON.parse(xhr.response)\r\n                console.log(response)\r\n                \r\n                if(response.status === 'fail'){\r\n                    otp_input.focus()\r\n                    otp_input.setCustomValidity('⚠️invalid OTP⚠️')\r\n                    otp_input.reportValidity()\r\n                    props.appbodyloading('none')\r\n                }else if (response.status === 'success'){\r\n                    set_Error('change_password')\r\n                    props.appbodyloading('none')\r\n                }\r\n            }\r\n        }\r\n\r\n        xhr.setRequestHeader('otp' , otp_input.value)\r\n        xhr.send()\r\n    })\r\n    const validotp= useCallback((e)=>{\r\n        if(e.target.value.length > 4){e.target.setCustomValidity('OTP must be of 4 digit');e.target.reportValidity()}\r\n        else if(e.target.value.length < 4){e.target.setCustomValidity('OTP must have 4 digits')}\r\n        else{e.target.setCustomValidity('')}\r\n    })\r\n\r\n    let otp_form = useMemo(()=>(<>\r\n            <h1 align='center' ref = {el =>ref.current['heading'] =el} >OTP</h1>\r\n            <div className = \"forgot_form\"  >\r\n            <form action=\"javascript:void(0);\" onSubmit = {forgot_pass_otp} >\r\n            <input type=\"number\" onInput={validotp} id= \"password\"\r\n            ref = {el=>ref.current['password']=el}  \r\n            placeholder= \"OTP\" required = {true}\r\n            style= {{fontSize : '35px', letterSpacing : \"20px\" , paddingLeft: \"60px\"}}\r\n             />\r\n            <input className='submit' type=\"submit\"  value= 'Submit'   />\r\n            </form>\r\n        </div>\r\n    </>))\r\n\r\n    let change_pass =useCallback( event =>{\r\n        let form = event.target\r\n        let password_input = form[1]\r\n\r\n        let xhr = new XMLHttpRequest()\r\n        xhr.open('POST' , origin + 'backend_api/changepassword')\r\n        props.appbodyloading('flex')\r\n\r\n        xhr.onreadystatechange  = ()=>{\r\n            if (xhr.status === 200 && xhr.readyState === 4){\r\n                let response  = JSON.parse(xhr.response)\r\n                \r\n                if (response.status === 'fail'){\r\n                    password_input.focus()\r\n                    password_input.setCustomValidity('Something went wrong')\r\n                    password_input.reportValidity()\r\n                    props.appbodyloading('none')\r\n                }else if (response.status === 'success'){\r\n                    set_Error('form')\r\n                    props.appbodyloading('none')\r\n                }\r\n            }\r\n        }\r\n\r\n        xhr.setRequestHeader('newpass' , password_input.value)\r\n        xhr.send()\r\n    })\r\n\r\n\r\n    let change_pass_from = useMemo(()=>(\r\n        <><h1 align='center' ref = {el =>ref.current['heading'] =el} >Change</h1>\r\n    <form action= 'javascript:void(0);'  onSubmit = {change_pass} >  \r\n    <input type=\"password\" minLength={8} maxLength={100} id='password' ref = {el=>ref.current['password']=el}  placeholder= \"New password\" required = {true} />\r\n        <input type=\"password\" minLength={8} maxLength={100} id='password' onInput = {(e)=>e.target.setCustomValidity('')} ref = {el=>ref.current['confirm_password']=el}  placeholder= \"Confirm password\" required = {true} />\r\n        <input className='submit' type=\"submit\"  value= 'Change'   />\r\n                    \r\n    </form></>\r\n    ))\r\n\r\n\r\n    return (\r\n        <div className=\"login\">\r\n            <div className=\"form\" ref = {el =>ref.current['form'] = el}>\r\n                 {Error === \"form\"?login_form :null }\r\n                 {Error === \"ask_email\"? email_form :null}\r\n                 {Error === \"otp\" ? otp_form :null}\r\n                 {Error === \"change_password\" ? change_pass_from :null}\r\n                 {Error === \"error\"? error_msg:null}\r\n\r\n                \r\n\r\n                \r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default AppLogin;"]},"metadata":{},"sourceType":"module"}